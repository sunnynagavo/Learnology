import{bF as Q,bG as e,bH as Et,bI as Pt,bJ as Rt,bK as Mt,r as a,bL as Ke,bM as Ut,bN as Ft,bO as Bt,bP as qt,bQ as $t,bR as Vt,bS as Ot,bT as Gt,bU as Dt,bV as Ht,bW as Qt,bX as zt,bY as Oe,bZ as Kt}from"./vendor-78e4629b.js";import{D as We,S as v,I as Ne,P as Wt,T as Le,a as Jt,B as re,b as Xt,c as Yt,M as Zt,d as es,L as ts,e as ss,f as ve,C as ns,g as Je,h as te,i as Xe,j as os,k as Ge,l as as,m as rs,n as De,o as is,p as cs,q as ls,r as O,s as ds,t as us,u as be}from"./fluentui-react-6d318832.js";import{e as hs,E as ps,f as gs,g as ms,D as Ye,h as xs,i as _s}from"./fluentui-icons-239535fc.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const d of o)if(d.type==="childList")for(const c of d.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const d={};return o.integrity&&(d.integrity=o.integrity),o.referrerPolicy&&(d.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?d.credentials="include":o.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function i(o){if(o.ep)return;o.ep=!0;const d=n(o);fetch(o.href,d)}})();const fs=".auth/me",Ss=".auth/refresh",ys=".auth/logout?post_logout_redirect_uri=/";async function js(){const t=await fetch("/auth_setup");if(!t.ok)throw new Error(`auth setup response was not ok: ${t.status}`);return await t.json()}const z=await js(),R=z.useLogin,oe=z.requireAccessControl,ws=z.msalConfig,Cs=z.loginRequest,vs=z.tokenRequest,Ze=()=>window.location.origin+z.msalConfig.auth.redirectUri,bs=()=>fetch(Ss).then(t=>t.ok?fetch(fs).then(s=>s.ok?s.json().then(n=>n.length>0?{id_token:n[0].id_token,access_token:n[0].access_token,user_claims:n[0].user_claims.reduce((i,o)=>(i[o.typ]=o.val,i),{})}:null):null):null),G=await bs(),ks=()=>{window.location.href=ys},me=t=>t?.getActiveAccount()!=null||G!=null,ae=t=>G?Promise.resolve(G.access_token):t.acquireTokenSilent({...vs,redirectUri:Ze()}).then(s=>s.accessToken).catch(s=>{console.log(s)});const Ts="_layout_1nrkm_1",Ns="_header_1nrkm_7",Ls="_headerContainer_1nrkm_12",As="_headerTitleContainer_1nrkm_20",Is="_headerLogo_1nrkm_28",Es="_headerTitle_1nrkm_20",Ps="_headerNavList_1nrkm_37",Rs="_headerNavPageLink_1nrkm_43",Ms="_headerNavPageLinkActive_1nrkm_57",Us="_headerNavLeftMargin_1nrkm_62",Fs="_headerRightText_1nrkm_66",Bs="_microsoftLogo_1nrkm_71",qs="_githubLogo_1nrkm_76",A={layout:Ts,header:Ns,headerContainer:Ls,headerTitleContainer:As,headerLogo:Is,headerTitle:Es,headerNavList:Ps,headerNavPageLink:Rs,headerNavPageLinkActive:Ms,headerNavLeftMargin:Us,headerRightText:Fs,microsoftLogo:Bs,githubLogo:qs},$s="_loginButton_m8yze_1",Vs={loginButton:$s},Os=()=>{const{instance:t}=Q(),s=t.getActiveAccount(),n=(s||G)!=null,i=()=>{t.loginPopup({...Cs,redirectUri:Ze()}).catch(c=>console.log(c))},o=()=>{s?t.logoutPopup({mainWindowRedirectUri:"/",account:t.getActiveAccount()}).catch(c=>console.log(c)):ks()},d=`Logout
${s?.username??G?.user_claims?.preferred_username}`;return e.jsx(We,{text:n?d:"Login",className:Vs.loginButton,onClick:n?o:i})},He=()=>e.jsxs("div",{className:A.layout,children:[e.jsx("header",{className:A.header,role:"banner",children:e.jsxs("div",{className:A.headerContainer,children:[e.jsx(Et,{to:"/",className:A.headerTitleContainer,children:e.jsx("h3",{className:A.headerTitle,children:"Learntology"})}),e.jsx("nav",{children:e.jsxs("ul",{className:A.headerNavList,children:[e.jsx("li",{children:e.jsx(Pt,{to:"/",className:({isActive:t})=>t?A.headerNavPageLinkActive:A.headerNavPageLink,children:"Chat"})}),e.jsx("li",{className:A.headerNavLeftMargin})]})}),e.jsx("h4",{className:A.headerRightText,children:"Learn python through chatting"}),R&&e.jsx(Os,{})]})}),e.jsx(Rt,{})]}),Gs="_container_ggo0d_1",Ds="_chatRoot_ggo0d_8",Hs="_chatContainer_ggo0d_13",Qs="_chatEmptyState_ggo0d_21",zs="_chatEmptyStateTitle_ggo0d_31",Ks="_chatEmptyStateSubtitle_ggo0d_38",Ws="_chatMessageStream_ggo0d_54",Js="_chatMessageGpt_ggo0d_66",Xs="_chatMessageGptMinWidth_ggo0d_73",Ys="_chatInput_ggo0d_78",Zs="_chatAnalysisPanel_ggo0d_91",en="_chatSettingsSeparator_ggo0d_99",tn="_loadingLogo_ggo0d_105",sn="_commandsContainer_ggo0d_109",nn="_commandButton_ggo0d_114",m={container:Gs,chatRoot:Ds,chatContainer:Hs,chatEmptyState:Qs,chatEmptyStateTitle:zs,chatEmptyStateSubtitle:Ks,chatMessageStream:Ws,chatMessageGpt:Js,chatMessageGptMinWidth:Xs,chatInput:Ys,chatAnalysisPanel:Zs,chatSettingsSeparator:en,loadingLogo:tn,commandsContainer:sn,commandButton:nn},xe="";function K(t){return R&&G==null&&t?{Authorization:`Bearer ${t}`}:{}}async function on(){return await(await fetch(`${xe}/config`,{method:"GET"})).json()}async function Po(t,s){const n=await fetch(`${xe}/ask`,{method:"POST",headers:{...K(s),"Content-Type":"application/json"},body:JSON.stringify(t)}),i=await n.json();if(n.status>299||!n.ok)throw Error(i.error||"Unknown error");return i}async function an(t,s){return await fetch(`${xe}/chat`,{method:"POST",headers:{...K(s),"Content-Type":"application/json"},body:JSON.stringify(t)})}function et(t){return`${xe}/content/${t}`}async function rn(t,s){const n=await fetch("/upload",{method:"POST",headers:K(s),body:t});if(!n.ok)throw new Error(`Uploading files failed: ${n.statusText}`);return await n.json()}async function cn(t,s){const n=await fetch("/delete_uploaded",{method:"POST",headers:{...K(s),"Content-Type":"application/json"},body:JSON.stringify({filename:t})});if(!n.ok)throw new Error(`Deleting file failed: ${n.statusText}`);return await n.json()}async function ln(t){const s=await fetch("/list_uploaded",{method:"GET",headers:K(t)});if(!s.ok)throw new Error(`Listing files failed: ${s.statusText}`);return await s.json()}var b=(t=>(t.Hybrid="hybrid",t.Vectors="vectors",t.Text="text",t))(b||{}),U=(t=>(t.TextAndImages="textAndImages",t.Images="images",t.Texts="texts",t))(U||{}),L=(t=>(t.Embedding="embedding",t.ImageEmbedding="imageEmbedding",t.Both="both",t))(L||{});const dn="_answerContainer_1sqax_1",un="_answerLogo_1sqax_11",hn="_answerText_1sqax_15",pn="_selected_1sqax_34",gn="_citationLearnMore_1sqax_38",mn="_citation_1sqax_38",xn="_followupQuestionsList_1sqax_60",_n="_followupQuestionLearnMore_1sqax_64",fn="_followupQuestion_1sqax_60",Sn="_supContainer_1sqax_83",yn="_retryButton_1sqax_112",jn="_loadingdots_1sqax_134",wn="_loading_1sqax_134",k={answerContainer:dn,answerLogo:un,answerText:hn,selected:pn,citationLearnMore:gn,citation:mn,followupQuestionsList:xn,followupQuestionLearnMore:_n,followupQuestion:fn,supContainer:Sn,retryButton:yn,loadingdots:jn,loading:wn};function Cn(t,s,n){const i=[];let o=t.trim();if(s){let u=o.length;for(let h=o.length-1;h>=0&&o[h]!=="]";h--)if(o[h]==="["){u=h;break}o=o.substring(0,u)}return{answerHtml:o.split(/\[([^\]]+)\]/g).map((u,p)=>{if(p%2===0)return u;{let h;i.indexOf(u)!==-1?h=i.indexOf(u)+1:(i.push(u),h=i.length);const g=et(u);return Mt(e.jsx("a",{className:"supContainer",title:u,onClick:()=>n(g),children:e.jsx("sup",{children:h})}))}}).join(""),citations:i}}const tt=()=>e.jsx(hs,{primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Answer logo"}),Qe=({answer:t,isSelected:s,isStreaming:n,onCitationClicked:i,onThoughtProcessClicked:o,onSupportingContentClicked:d,onFollowupQuestionClicked:c,showFollowupQuestions:u})=>{const p=t.choices[0].context.followup_questions,h=t.choices[0].message.content,g=a.useMemo(()=>Cn(h,n,i),[t]),_=Ke.sanitize(g.answerHtml);return e.jsxs(v,{className:`${k.answerContainer} ${s&&k.selected}`,verticalAlign:"space-between",children:[e.jsx(v.Item,{children:e.jsxs(v,{horizontal:!0,horizontalAlign:"space-between",children:[e.jsx(tt,{}),e.jsxs("div",{children:[e.jsx(Ne,{style:{color:"black"},iconProps:{iconName:"Lightbulb"},title:"Show thought process",ariaLabel:"Show thought process",onClick:()=>o(),disabled:!t.choices[0].context.thoughts?.length}),e.jsx(Ne,{style:{color:"black"},iconProps:{iconName:"ClipboardList"},title:"Show supporting content",ariaLabel:"Show supporting content",onClick:()=>d(),disabled:!t.choices[0].context.data_points})]})]})}),e.jsx(v.Item,{grow:!0,children:e.jsx("div",{className:k.answerText,dangerouslySetInnerHTML:{__html:_}})}),!!g.citations.length&&e.jsx(v.Item,{children:e.jsxs(v,{horizontal:!0,wrap:!0,tokens:{childrenGap:5},children:[e.jsx("span",{className:k.citationLearnMore,children:"Citations:"}),g.citations.map((f,y)=>{const S=et(f);return e.jsx("a",{className:k.citation,title:f,onClick:()=>i(S),children:`${++y}. ${f}`},y)})]})}),!!p?.length&&u&&c&&e.jsx(v.Item,{children:e.jsxs(v,{horizontal:!0,wrap:!0,className:`${g.citations.length?k.followupQuestionsList:""}`,tokens:{childrenGap:6},children:[e.jsx("span",{className:k.followupQuestionLearnMore,children:"Follow-up questions:"}),p.map((f,y)=>e.jsx("a",{className:k.followupQuestion,title:f,onClick:()=>c(f),children:`${f}`},y))]})})]})},vn=()=>{const t=Ut({from:{opacity:0},to:{opacity:1}});return e.jsx(Ft.div,{style:{...t},children:e.jsxs(v,{className:k.answerContainer,verticalAlign:"space-between",children:[e.jsx(tt,{}),e.jsx(v.Item,{grow:!0,children:e.jsxs("p",{className:k.answerText,children:["Generating answer",e.jsx("span",{className:k.loadingdots})]})})]})})},bn=({error:t,onRetry:s})=>e.jsxs(v,{className:k.answerContainer,verticalAlign:"space-between",children:[e.jsx(ps,{"aria-hidden":"true","aria-label":"Error icon",primaryFill:"red"}),e.jsx(v.Item,{grow:!0,children:e.jsx("p",{className:k.answerText,children:t})}),e.jsx(Wt,{className:k.retryButton,onClick:s,text:"Retry"})]}),kn="_questionInputContainer_hiipw_1",Tn="_questionInputTextArea_hiipw_12",Nn="_questionInputButtonsContainer_hiipw_17",ke={questionInputContainer:kn,questionInputTextArea:Tn,questionInputButtonsContainer:Nn},Ln=({onSend:t,disabled:s,placeholder:n,clearOnSend:i,initQuestion:o})=>{const[d,c]=a.useState("");a.useEffect(()=>{o&&c(o)},[o]);const u=()=>{s||!d.trim()||(t(d),i&&c(""))},p=y=>{y.key==="Enter"&&!y.shiftKey&&(y.preventDefault(),u())},h=(y,S)=>{S?S.length<=1e3&&c(S):c("")},{instance:g}=Q(),_=oe&&!me(g),f=s||!d.trim()||_;return _&&(n="Please login to continue..."),e.jsxs(v,{horizontal:!0,className:ke.questionInputContainer,children:[e.jsx(Le,{className:ke.questionInputTextArea,disabled:_,placeholder:n,multiline:!0,resizable:!1,borderless:!0,value:d,onChange:h,onKeyDown:p}),e.jsx("div",{className:ke.questionInputButtonsContainer,children:e.jsx(Jt,{content:"Ask question button",relationship:"label",children:e.jsx(re,{size:"large",icon:e.jsx(gs,{primaryFill:"rgba(115, 118, 225, 1)"}),disabled:f,onClick:u})})})]})},An="_examplesNavList_o3hyg_1",In="_example_o3hyg_1",En="_exampleText_o3hyg_29",Ae={examplesNavList:An,example:In,exampleText:En},Pn=({text:t,value:s,onClick:n})=>e.jsx("div",{className:Ae.example,onClick:()=>n(s),children:e.jsx("p",{className:Ae.exampleText,children:t})}),Rn=["What is Python?","How to write a function?","How to write a loop?"],Mn=["List Values and types of python","What are assignment statements in python?","List string operations of python?"],Un=({onExampleClicked:t,useGPT4V:s})=>e.jsx("ul",{className:Ae.examplesNavList,children:(s?Mn:Rn).map((n,i)=>e.jsx("li",{children:e.jsx(Pn,{text:n,value:n,onClick:t})},i))}),Fn="_container_1p3pb_1",Bn="_message_1p3pb_9",ze={container:Fn,message:Bn},ge=({message:t})=>e.jsx("div",{className:ze.container,children:e.jsx("div",{className:ze.message,children:t})}),qn="_thoughtProcess_1ooqd_1",$n="_tList_1ooqd_8",Vn="_tListItem_1ooqd_14",On="_tStep_1ooqd_40",Gn="_tCodeBlock_1ooqd_47",Dn="_tProp_1ooqd_51",Hn="_citationImg_1ooqd_60",H={thoughtProcess:qn,tList:$n,tListItem:Vn,tStep:On,tCodeBlock:Gn,tProp:Dn,citationImg:Hn};function Qn(t){const s=t.split(": "),n=s[0],i=Ke.sanitize(s.slice(1).join(": "));return{title:n,content:i}}const zn="_supportingContentNavList_beb5d_1",Kn="_supportingContentItem_beb5d_9",Wn="_supportingContentItemHeader_beb5d_23",Jn="_supportingContentItemText_beb5d_27",Xn="_supportingContentItemImage_beb5d_32",se={supportingContentNavList:zn,supportingContentItem:Kn,supportingContentItemHeader:Wn,supportingContentItemText:Jn,supportingContentItemImage:Xn},Yn=({supportingContent:t})=>{const s=Array.isArray(t)?t:t.text,n=Array.isArray(t)?[]:t?.images;return e.jsxs("ul",{className:se.supportingContentNavList,children:[s.map((i,o)=>{const d=Qn(i);return e.jsxs("li",{className:se.supportingContentItem,children:[e.jsx("h4",{className:se.supportingContentItemHeader,children:d.title}),e.jsx("p",{className:se.supportingContentItemText,dangerouslySetInnerHTML:{__html:d.content}})]},o)}),n?.map((i,o)=>e.jsx("img",{className:se.supportingContentItemImage,src:i.url},o))]})};var I=(t=>(t.ThoughtProcessTab="thoughtProcess",t.SupportingContentTab="supportingContent",t.CitationTab="citation",t))(I||{});const Zn=({thoughts:t})=>e.jsx("ul",{className:H.tList,children:t.map((s,n)=>e.jsxs("li",{className:H.tListItem,children:[e.jsx("div",{className:H.tStep,children:s.title}),e.jsx(v,{horizontal:!0,tokens:{childrenGap:5},children:s.props&&(Object.keys(s.props)||[]).map(i=>e.jsxs("span",{className:H.tProp,children:[i,": ",JSON.stringify(s.props?.[i])]}))}),Array.isArray(s.description)?e.jsx(Bt,{language:"json",wrapLongLines:!0,className:H.tCodeBlock,children:JSON.stringify(s.description,null,2)}):e.jsx("div",{children:s.description})]},n))}),eo="_downloadButton_1o536_1",to="_markdownViewer_1o536_6",so="_loading_1o536_15",no="_error_1o536_21",oo="_markdown_1o536_6",$={downloadButton:eo,markdownViewer:to,loading:so,error:no,markdown:oo},ao=({src:t})=>{const[s,n]=a.useState(""),[i,o]=a.useState(!0),[d,c]=a.useState(null),u=p=>{const h=/<a\s+(?:[^>]*?\s+)?href=['"](#[^"']*?)['"][^>]*?>/g;return p.replace(h,"")};return a.useEffect(()=>{(async()=>{try{const h=await fetch(t);if(!h.ok)throw new Error("Failed loading markdown file.");const g=await h.text(),_=await qt.parse(g),f=u(_);n(f)}catch(h){c(h)}finally{o(!1)}})()},[t]),e.jsx("div",{children:i?e.jsx("div",{className:`${$.loading} ${$.markdownViewer}`,children:e.jsx(Xt,{size:Yt.large,label:"Loading file"})}):d?e.jsx("div",{className:`${$.error} ${$.markdownViewer}`,children:e.jsxs(Zt,{messageBarType:es.error,isMultiline:!1,children:[d.message,e.jsx(ts,{href:t,download:!0,children:"Download the file"})]})}):e.jsxs("div",{children:[e.jsx(Ne,{className:$.downloadButton,style:{color:"black"},iconProps:{iconName:"Save"},title:"Save",ariaLabel:"Save",href:t,download:!0}),e.jsx("div",{className:`${$.markdown} ${$.markdownViewer}`,dangerouslySetInnerHTML:{__html:s}})]})})},Te={disabled:!0,style:{color:"grey"}},ro=({answer:t,activeTab:s,activeCitation:n,citationHeight:i,className:o,onActiveTabChanged:d})=>{const c=!t.choices[0].context.thoughts,u=!t.choices[0].context.data_points,p=!n,[h,g]=a.useState(""),_=R?Q().instance:void 0,f=async()=>{const S=_?await ae(_):void 0;if(n){const F=n.indexOf("#")?n.split("#")[1]:"",W=await(await fetch(n,{method:"GET",headers:K(S)})).blob();let E=URL.createObjectURL(W);F&&(E+="#"+F),g(E)}};a.useEffect(()=>{f()},[]);const y=()=>{if(!n)return null;switch(n.split(".").pop()?.toLowerCase()){case"png":return e.jsx("img",{src:h,className:H.citationImg,alt:"Citation Image"});case"md":return e.jsx(ao,{src:n});default:return e.jsx("iframe",{title:"Citation",src:h,width:"100%",height:i})}};return e.jsxs(ss,{className:o,selectedKey:s,onLinkClick:S=>S&&d(S.props.itemKey),children:[e.jsx(ve,{itemKey:I.ThoughtProcessTab,headerText:"Thought process",headerButtonProps:c?Te:void 0,children:e.jsx(Zn,{thoughts:t.choices[0].context.thoughts||[]})}),e.jsx(ve,{itemKey:I.SupportingContentTab,headerText:"Supporting content",headerButtonProps:u?Te:void 0,children:e.jsx(Yn,{supportingContent:t.choices[0].context.data_points})}),e.jsx(ve,{itemKey:I.CitationTab,headerText:"Citation",headerButtonProps:p?Te:void 0,children:y()})]})},io="_container_cfwv2_1",co={container:io},lo=({className:t,onClick:s})=>e.jsx("div",{className:`${co.container} ${t??""}`,children:e.jsx(re,{icon:e.jsx(ms,{}),onClick:s,children:"Developer settings"})}),uo="_container_cfwv2_1",ho={container:uo},po=({className:t,disabled:s,onClick:n})=>e.jsx("div",{className:`${ho.container} ${t??""}`,children:e.jsx(re,{icon:e.jsx(Ye,{}),disabled:s,onClick:n,children:"Clear chat"})}),go="_container_x2g71_1",mo="_callout_x2g71_8",xo="_list_x2g71_13",_o="_item_x2g71_19",ne={container:go,callout:mo,list:xo,item:_o},fo=({className:t,disabled:s})=>{const[n,i]=a.useState(!1),[o,d]=a.useState(!1),[c,u]=a.useState(!0),[p,h]=a.useState({}),[g,_]=a.useState(),[f,y]=a.useState(),[S,F]=a.useState([]);if(!R)throw new Error("The UploadFile component requires useLogin to be true");const M=Q().instance,W=async()=>{i(!n);try{const x=await ae(M);if(!x)throw new Error("No authentication token available");E(x)}catch(x){console.error(x),u(!1)}},E=async x=>{ln(x).then(w=>{u(!1),h({}),F(w)})},_e=async x=>{h({...p,[x]:"pending"});try{const w=await ae(M);if(!w)throw new Error("No authentication token available");await cn(x,w),h({...p,[x]:"success"}),E(w)}catch(w){h({...p,[x]:"error"}),console.error(w)}},ie=async x=>{if(x.preventDefault(),!x.target.files||x.target.files.length===0)return;d(!0);const w=x.target.files[0],ce=new FormData;ce.append("file",w);try{const B=await ae(M);if(!B)throw new Error("No authentication token available");const fe=await rn(ce,B);_(fe),d(!1),y(void 0),E(B)}catch(B){console.error(B),d(!1),y("Error uploading file - please try again or contact admin.")}};return e.jsx("div",{className:`${ne.container} ${t??""}`,children:e.jsxs("div",{children:[e.jsx(re,{id:"calloutButton",icon:e.jsx(xs,{}),disabled:s,onClick:W,children:"Manage file uploads"}),n&&e.jsxs(ns,{role:"dialog",gapSpace:0,className:ne.callout,target:"#calloutButton",onDismiss:()=>i(!1),setInitialFocus:!0,children:[e.jsx("form",{encType:"multipart/form-data",children:e.jsxs("div",{children:[e.jsx(Je,{children:"Upload file:"}),e.jsx("input",{accept:".txt, .md, .json, .jpg, .jpeg, .bmp, .heic, .tiff, .pdf, .docx, .xlsx, .pptx, .html",className:ne.chooseFiles,type:"file",onChange:ie})]})}),o&&e.jsx(te,{children:"Uploading files..."}),!o&&f&&e.jsx(te,{children:f}),!o&&g&&e.jsx(te,{children:g.message}),e.jsx("h3",{children:"Previously uploaded files:"}),c&&e.jsx(te,{children:"Loading..."}),!c&&S.length===0&&e.jsx(te,{children:"No files uploaded yet"}),S.map((x,w)=>e.jsxs("div",{className:ne.list,children:[e.jsx("div",{className:ne.item,children:x}),e.jsxs(re,{icon:e.jsx(Ye,{}),onClick:()=>_e(x),disabled:p[x]==="pending"||p[x]==="success",children:[!p[x]&&"Delete file",p[x]=="pending"&&"Deleting file...",p[x]=="error"&&"Error deleting.",p[x]=="success"&&"File deleted"]})]},w))]})]})})},So="_container_1pzrp_1",yo={container:So},jo=[{key:L.Embedding,text:"Text Embeddings"},{key:L.ImageEmbedding,text:"Image Embeddings"},{key:L.Both,text:"Text and Image embeddings"}],wo=({updateRetrievalMode:t,updateVectorFields:s,showImageOptions:n})=>{const[i,o]=a.useState(b.Hybrid),[d,c]=a.useState(),u=(h,g)=>{o(g?.data||b.Hybrid),t(g?.data||b.Hybrid)},p=(h,g)=>{g&&c(g.key);let _;g?.key==="both"?_=[L.Embedding,L.ImageEmbedding]:_=[g?.key],s(_)};return a.useEffect(()=>{s(n?[L.Embedding,L.ImageEmbedding]:[L.Embedding])},[n]),e.jsxs(v,{className:yo.container,tokens:{childrenGap:10},children:[e.jsx(Xe,{label:"Retrieval mode",options:[{key:"hybrid",text:"Vectors + Text (Hybrid)",selected:i==b.Hybrid,data:b.Hybrid},{key:"vectors",text:"Vectors",selected:i==b.Vectors,data:b.Vectors},{key:"text",text:"Text",selected:i==b.Text,data:b.Text}],required:!0,onChange:u}),n&&[b.Vectors,b.Hybrid].includes(i)&&e.jsx(os,{options:jo,onChange:p,selectedKey:d,defaultSelectedKey:L.Both,label:"Vector Fields (Multi-query vector search)"})]})},Co=()=>{const{instance:t}=Q(),s=t.getActiveAccount(),n=c=>typeof c=="string"?c:JSON.stringify(c),o=(c=>Object.keys(c??{}).map(u=>{let p=u;try{const g=new URL(u).pathname.split("/");u=g[g.length-1]}catch{}return{name:u,value:n((c??{})[p])}}))(s?.idTokenClaims??G?.user_claims),d=[Ge({columnId:"name",compare:(c,u)=>c.name.localeCompare(u.name),renderHeaderCell:()=>"Name",renderCell:c=>c.name}),Ge({columnId:"value",compare:(c,u)=>c.value.localeCompare(u.value),renderHeaderCell:()=>"Value",renderCell:c=>c.value})];return e.jsxs("div",{children:[e.jsx(Je,{children:"ID Token Claims"}),e.jsxs(as,{items:o,columns:d,sortable:!0,getRowId:c=>c.name,children:[e.jsx(rs,{children:e.jsx(De,{children:({renderHeaderCell:c})=>e.jsx(is,{children:c()})})}),e.jsx(cs,{children:({item:c,rowId:u})=>e.jsx(De,{children:({renderCell:p})=>e.jsx(ls,{children:p(c)})},u)})]})]})},vo="_container_1pzrp_1",bo={container:vo},ko=({updateGPT4VInputs:t,updateUseGPT4V:s,isUseGPT4V:n,gpt4vInputs:i})=>{const[o,d]=a.useState(n),[c,u]=a.useState(i||U.TextAndImages),p=(g,_)=>{s(!!_),d(!!_)},h=(g,_)=>{if(_){const f=_.key;t(f||U.TextAndImages),f&&u(f)}};return a.useEffect(()=>{o&&t(U.TextAndImages)},[o]),e.jsxs(v,{className:bo.container,tokens:{childrenGap:10},children:[e.jsx(O,{checked:o,label:"Use GPT-4 Turbo with Vision",onChange:p}),o&&e.jsx(Xe,{selectedKey:c,label:"GPT-4 Turbo with Vision Inputs",options:[{key:U.TextAndImages,text:"Images and text from index"},{text:"Images only",key:U.Images},{text:"Text only",key:U.Texts}],required:!0,onChange:h})]})},To=()=>{const[t,s]=a.useState(!1),[n,i]=a.useState(""),[o,d]=a.useState(.3),[c,u]=a.useState(0),[p,h]=a.useState(0),[g,_]=a.useState(3),[f,y]=a.useState(b.Hybrid),[S,F]=a.useState(!0),[M,W]=a.useState(!0),[E,_e]=a.useState(!1),[ie,x]=a.useState(""),[w,ce]=a.useState(!1),[B,fe]=a.useState([L.Embedding]),[Ee,st]=a.useState(!1),[Pe,nt]=a.useState(!1),[Re,ot]=a.useState(U.TextAndImages),[le,at]=a.useState(!1),q=a.useRef(""),Se=a.useRef(null),[de,ue]=a.useState(!1),[Me,ye]=a.useState(!1),[he,je]=a.useState(),[Ue,we]=a.useState(),[J,D]=a.useState(void 0),[X,Fe]=a.useState(0),[T,pe]=a.useState([]),[Be,qe]=a.useState([]),[$e,rt]=a.useState(!1),[it,ct]=a.useState(!1),[lt,dt]=a.useState(!1),[ut,ht]=a.useState(!1),pt=async()=>{on().then(r=>{rt(r.showGPT4VOptions),F(r.showSemanticRankerOption),ct(r.showSemanticRankerOption),dt(r.showVectorOption),r.showVectorOption||y(b.Text),ht(r.showUserUpload)})},gt=async(r,l,N,Ce)=>{let P="",j={};const Lt=C=>new Promise(At=>{setTimeout(()=>{P+=C;const It={...j,choices:[{...j.choices[0],message:{content:P,role:j.choices[0].message.role}}]};qe([...l,[r,It]]),At(null)},33)});try{ye(!0);for await(const C of $t(Ce))if(C.choices&&C.choices[0].context&&C.choices[0].context.data_points)C.choices[0].message=C.choices[0].delta,j=C;else if(C.choices&&C.choices[0].delta.content)ue(!1),await Lt(C.choices[0].delta.content);else if(C.choices&&C.choices[0].context)j.choices[0].context={...j.choices[0].context,...C.choices[0].context};else if(C.error)throw Error(C.error)}finally{ye(!1)}return{...j,choices:[{...j.choices[0],message:{content:P,role:j.choices[0].message.role}}]}},Y=R?Q().instance:void 0,Z=async r=>{q.current=r,he&&je(void 0),ue(!0),we(void 0),D(void 0);const l=Y?await ae(Y):void 0;try{const Ce={messages:[...T.flatMap(j=>[{content:j[0],role:"user"},{content:j[1].choices[0].message.content,role:"assistant"}]),{content:r,role:"user"}],stream:M,context:{overrides:{prompt_template:n.length===0?void 0:n,exclude_category:ie.length===0?void 0:ie,top:g,temperature:o,minimum_reranker_score:c,minimum_search_score:p,retrieval_mode:f,semantic_ranker:S,semantic_captions:E,suggest_followup_questions:w,use_oid_security_filter:Ee,use_groups_security_filter:Pe,vector_fields:B,use_gpt4v:le,gpt4v_input:Re}},session_state:T.length?T[T.length-1][1].choices[0].session_state:null},P=await an(Ce,l);if(!P.body)throw Error("No response body");if(M){const j=await gt(r,T,pe,P.body);pe([...T,[r,j]])}else{const j=await P.json();if(P.status>299||!P.ok)throw Error(j.error||"Unknown error");pe([...T,[r,j]])}}catch(N){je(N)}finally{ue(!1)}},mt=()=>{q.current="",he&&je(void 0),we(void 0),D(void 0),pe([]),qe([]),ue(!1),ye(!1)};a.useEffect(()=>Se.current?.scrollIntoView({behavior:"smooth"}),[de]),a.useEffect(()=>Se.current?.scrollIntoView({behavior:"auto"}),[Be]),a.useEffect(()=>{pt()},[]);const xt=(r,l)=>{i(l||"")},_t=(r,l,N)=>{d(r)},ft=(r,l)=>{h(parseFloat(l||"0"))},St=(r,l)=>{u(parseFloat(l||"0"))},yt=(r,l)=>{_(parseInt(l||"3"))},jt=(r,l)=>{F(!!l)},wt=(r,l)=>{_e(!!l)},Ct=(r,l)=>{W(!!l)},vt=(r,l)=>{x(l||"")},bt=(r,l)=>{ce(!!l)},kt=(r,l)=>{st(!!l)},Tt=(r,l)=>{nt(!!l)},Nt=r=>{Z(r)},Ve=(r,l)=>{Ue===r&&J===I.CitationTab&&X===l?D(void 0):(we(r),D(I.CitationTab)),Fe(l)},ee=(r,l)=>{D(J===r&&X===l?void 0:r),Fe(l)};return e.jsxs("div",{className:m.container,children:[e.jsxs("div",{className:m.commandsContainer,children:[e.jsx(po,{className:m.commandButton,onClick:mt,disabled:!q.current||de}),ut&&e.jsx(fo,{className:m.commandButton,disabled:!me(Y)}),e.jsx(lo,{className:m.commandButton,onClick:()=>s(!t)})]}),e.jsxs("div",{className:m.chatRoot,children:[e.jsxs("div",{className:m.chatContainer,children:[q.current?e.jsxs("div",{className:m.chatMessageStream,children:[Me&&Be.map((r,l)=>e.jsxs("div",{children:[e.jsx(ge,{message:r[0]}),e.jsx("div",{className:m.chatMessageGpt,children:e.jsx(Qe,{isStreaming:!0,answer:r[1],isSelected:!1,onCitationClicked:N=>Ve(N,l),onThoughtProcessClicked:()=>ee(I.ThoughtProcessTab,l),onSupportingContentClicked:()=>ee(I.SupportingContentTab,l),onFollowupQuestionClicked:N=>Z(N),showFollowupQuestions:w&&T.length-1===l},l)})]},l)),!Me&&T.map((r,l)=>e.jsxs("div",{children:[e.jsx(ge,{message:r[0]}),e.jsx("div",{className:m.chatMessageGpt,children:e.jsx(Qe,{isStreaming:!1,answer:r[1],isSelected:X===l&&J!==void 0,onCitationClicked:N=>Ve(N,l),onThoughtProcessClicked:()=>ee(I.ThoughtProcessTab,l),onSupportingContentClicked:()=>ee(I.SupportingContentTab,l),onFollowupQuestionClicked:N=>Z(N),showFollowupQuestions:w&&T.length-1===l},l)})]},l)),de&&e.jsxs(e.Fragment,{children:[e.jsx(ge,{message:q.current}),e.jsx("div",{className:m.chatMessageGptMinWidth,children:e.jsx(vn,{})})]}),he?e.jsxs(e.Fragment,{children:[e.jsx(ge,{message:q.current}),e.jsx("div",{className:m.chatMessageGptMinWidth,children:e.jsx(bn,{error:he.toString(),onRetry:()=>Z(q.current)})})]}):null,e.jsx("div",{ref:Se})]}):e.jsxs("div",{className:m.chatEmptyState,children:[e.jsx(_s,{fontSize:"120px",primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Chat logo"}),e.jsx("h1",{className:m.chatEmptyStateTitle,children:"Chat with us to learn python"}),e.jsx("h2",{className:m.chatEmptyStateSubtitle,children:"Ask anything that is related to python"}),e.jsx(Un,{onExampleClicked:Nt,useGPT4V:le})]}),e.jsx("div",{className:m.chatInput,children:e.jsx(Ln,{clearOnSend:!0,placeholder:"Type a new question (e.g. What are variables?)",disabled:de,onSend:r=>Z(r)})})]}),T.length>0&&J&&e.jsx(ro,{className:m.chatAnalysisPanel,activeCitation:Ue,onActiveTabChanged:r=>ee(r,X),citationHeight:"810px",answer:T[X][1],activeTab:J}),e.jsxs(ds,{headerText:"Configure answer generation",isOpen:t,isBlocking:!1,onDismiss:()=>s(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>e.jsx(We,{onClick:()=>s(!1),children:"Close"}),isFooterAtBottom:!0,children:[e.jsx(Le,{className:m.chatSettingsSeparator,defaultValue:n,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:xt}),e.jsx(us,{className:m.chatSettingsSeparator,label:"Temperature",min:0,max:1,step:.1,defaultValue:o,onChange:_t,showValue:!0,snapToStep:!0}),e.jsx(be,{className:m.chatSettingsSeparator,label:"Minimum search score",min:0,step:.01,defaultValue:p.toString(),onChange:ft}),e.jsx(be,{className:m.chatSettingsSeparator,label:"Minimum reranker score",min:1,max:4,step:.1,defaultValue:c.toString(),onChange:St}),e.jsx(be,{className:m.chatSettingsSeparator,label:"Retrieve this many search results:",min:1,max:50,defaultValue:g.toString(),onChange:yt}),e.jsx(Le,{className:m.chatSettingsSeparator,label:"Exclude category",onChange:vt}),it&&e.jsx(O,{className:m.chatSettingsSeparator,checked:S,label:"Use semantic ranker for retrieval",onChange:jt}),e.jsx(O,{className:m.chatSettingsSeparator,checked:E,label:"Use query-contextual summaries instead of whole documents",onChange:wt,disabled:!S}),e.jsx(O,{className:m.chatSettingsSeparator,checked:w,label:"Suggest follow-up questions",onChange:bt}),$e&&e.jsx(ko,{gpt4vInputs:Re,isUseGPT4V:le,updateUseGPT4V:r=>{at(r)},updateGPT4VInputs:r=>ot(r)}),lt&&e.jsx(wo,{showImageOptions:le&&$e,updateVectorFields:r=>fe(r),updateRetrievalMode:r=>y(r)}),R&&e.jsx(O,{className:m.chatSettingsSeparator,checked:Ee||oe,label:"Use oid security filter",disabled:!me(Y)||oe,onChange:kt}),R&&e.jsx(O,{className:m.chatSettingsSeparator,checked:Pe||oe,label:"Use groups security filter",disabled:!me(Y)||oe,onChange:Tt}),e.jsx(O,{className:m.chatSettingsSeparator,checked:M,label:"Stream chat completion responses",onChange:Ct}),R&&e.jsx(Co,{})]})]})]})};var Ie;if(R){var V=new Vt(ws);!V.getActiveAccount()&&V.getAllAccounts().length>0&&V.setActiveAccount(V.getActiveAccount()),V.addEventCallback(t=>{if(t.eventType===Ot.LOGIN_SUCCESS&&t.payload){const s=t.payload;V.setActiveAccount(s)}}),Ie=e.jsx(Kt,{instance:V,children:e.jsx(He,{})})}else Ie=e.jsx(He,{});Gt();const No=Dt([{path:"/",element:Ie,children:[{index:!0,element:e.jsx(To,{})},{path:"qa",lazy:()=>Oe(()=>import("./Ask-c1f9d376.js"),["assets/Ask-c1f9d376.js","assets/vendor-78e4629b.js","assets/fluentui-react-6d318832.js","assets/fluentui-icons-239535fc.js","assets/Ask-2f7211eb.css"])},{path:"*",lazy:()=>Oe(()=>import("./NoPage-662173a0.js"),["assets/NoPage-662173a0.js","assets/vendor-78e4629b.js"])}]}]);Ht.createRoot(document.getElementById("root")).render(e.jsx(Qt.StrictMode,{children:e.jsx(zt,{router:No})}));export{Qe as A,Un as E,U as G,Ln as Q,b as R,lo as S,Co as T,fo as U,L as V,I as a,bn as b,ro as c,ko as d,wo as e,on as f,ae as g,Po as h,me as i,oe as r,R as u};
//# sourceMappingURL=index-38f37ea9.js.map
