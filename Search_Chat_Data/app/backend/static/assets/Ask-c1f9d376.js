import{r as s,bF as Re,bG as t}from"./vendor-78e4629b.js";import{R as q,G as Ue,V as H,u as p,U as Ne,i as f,S as Oe,Q as Fe,E as Ge,A as Ie,a as d,b as Be,c as Ee,d as Me,e as Qe,r as S,T as Le,f as De,g as qe,h as He}from"./index-38f37ea9.js";import{b as ze,s as Je,D as Ke,T as z,t as We,u as y,r as g}from"./fluentui-react-6d318832.js";import"./fluentui-icons-239535fc.js";const Xe="_askContainer_mt7u7_1",Ye="_askTopSection_mt7u7_8",Ze="_askBottomSection_mt7u7_15",$e="_askTitle_mt7u7_25",et="_askQuestionInput_mt7u7_39",tt="_askAnswerContainer_mt7u7_46",st="_askAnalysisPanel_mt7u7_53",at="_askSettingsSeparator_mt7u7_58",nt="_commandsContainer_mt7u7_64",ot="_commandButton_mt7u7_69",a={askContainer:Xe,askTopSection:Ye,askBottomSection:Ze,askTitle:$e,askQuestionInput:et,askAnswerContainer:tt,askAnalysisPanel:st,askSettingsSeparator:at,commandsContainer:nt,commandButton:ot};function it(){const[b,h]=s.useState(!1),[k,J]=s.useState(""),[j,rt]=s.useState(""),[w,ct]=s.useState(""),[A,K]=s.useState(.3),[P,W]=s.useState(0),[V,X]=s.useState(0),[Y,R]=s.useState(q.Hybrid),[U,Z]=s.useState(3),[C,N]=s.useState(!0),[O,$]=s.useState(!1),[c,ee]=s.useState(!1),[F,te]=s.useState(Ue.TextAndImages),[G,se]=s.useState(""),[ae,ne]=s.useState(""),[oe,ie]=s.useState([H.Embedding,H.ImageEmbedding]),[I,re]=s.useState(!1),[B,ce]=s.useState(!1),[E,le]=s.useState(!1),[ue,me]=s.useState(!1),[pe,de]=s.useState(!1),[Se,ge]=s.useState(!1),_=s.useRef(""),[x,M]=s.useState(!1),[l,Q]=s.useState(),[o,he]=s.useState(),[L,D]=s.useState(),[u,i]=s.useState(void 0),r=p?Re().instance:void 0,ke=async()=>{De().then(e=>{le(e.showGPT4VOptions),N(e.showSemanticRankerOption),me(e.showSemanticRankerOption),de(e.showVectorOption),e.showVectorOption||R(q.Text),ge(e.showUserUpload)})};s.useEffect(()=>{ke()},[]);const v=async e=>{_.current=e,l&&Q(void 0),M(!0),D(void 0),i(void 0);const n=r?await qe(r):void 0;try{const m={messages:[{content:e,role:"user"}],context:{overrides:{prompt_template:k.length===0?void 0:k,prompt_template_prefix:j.length===0?void 0:j,prompt_template_suffix:w.length===0?void 0:w,exclude_category:G.length===0?void 0:G,top:U,temperature:A,minimum_reranker_score:P,minimum_search_score:V,retrieval_mode:Y,semantic_ranker:C,semantic_captions:O,use_oid_security_filter:I,use_groups_security_filter:B,vector_fields:oe,use_gpt4v:c,gpt4v_input:F}},session_state:o?o.choices[0].session_state:null},Ve=await He(m,n);he(Ve)}catch(m){Q(m)}finally{M(!1)}},Ce=(e,n)=>{J(n||"")},_e=(e,n,m)=>{K(e)},xe=(e,n)=>{X(parseFloat(n||"0"))},ve=(e,n)=>{W(parseFloat(n||"0"))},Te=(e,n)=>{Z(parseInt(n||"3"))},fe=(e,n)=>{N(!!n)},ye=(e,n)=>{$(!!n)},be=(e,n)=>{se(n||"")},je=e=>{v(e),ne(e)},we=e=>{L===e&&u===d.CitationTab?i(void 0):(D(e),i(d.CitationTab))},T=e=>{i(u===e?void 0:e)},Ae=(e,n)=>{re(!!n)},Pe=(e,n)=>{ce(!!n)};return t.jsxs("div",{className:a.askContainer,children:[t.jsxs("div",{className:a.askTopSection,children:[t.jsxs("div",{className:a.commandsContainer,children:[Se&&t.jsx(Ne,{className:a.commandButton,disabled:!f(r)}),t.jsx(Oe,{className:a.commandButton,onClick:()=>h(!b)})]}),t.jsx("h1",{className:a.askTitle,children:"Ask your data"}),t.jsx("div",{className:a.askQuestionInput,children:t.jsx(Fe,{placeholder:"Example: Does my plan cover annual eye exams?",disabled:x,initQuestion:ae,onSend:e=>v(e)})})]}),t.jsxs("div",{className:a.askBottomSection,children:[x&&t.jsx(ze,{label:"Generating answer"}),!_.current&&t.jsx(Ge,{onExampleClicked:je,useGPT4V:c}),!x&&o&&!l&&t.jsx("div",{className:a.askAnswerContainer,children:t.jsx(Ie,{answer:o,isStreaming:!1,onCitationClicked:e=>we(e),onThoughtProcessClicked:()=>T(d.ThoughtProcessTab),onSupportingContentClicked:()=>T(d.SupportingContentTab)})}),l?t.jsx("div",{className:a.askAnswerContainer,children:t.jsx(Be,{error:l.toString(),onRetry:()=>v(_.current)})}):null,u&&o&&t.jsx(Ee,{className:a.askAnalysisPanel,activeCitation:L,onActiveTabChanged:e=>T(e),citationHeight:"600px",answer:o,activeTab:u})]}),t.jsxs(Je,{headerText:"Configure answer generation",isOpen:b,isBlocking:!1,onDismiss:()=>h(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>t.jsx(Ke,{onClick:()=>h(!1),children:"Close"}),isFooterAtBottom:!0,children:[t.jsx(z,{className:a.askSettingsSeparator,defaultValue:k,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:Ce}),t.jsx(We,{className:a.chatSettingsSeparator,label:"Temperature",min:0,max:1,step:.1,defaultValue:A,onChange:_e,showValue:!0,snapToStep:!0}),t.jsx(y,{className:a.askSettingsSeparator,label:"Minimum search score",min:0,step:.01,defaultValue:V.toString(),onChange:xe}),t.jsx(y,{className:a.askSettingsSeparator,label:"Minimum reranker score",min:1,max:4,step:.1,defaultValue:P.toString(),onChange:ve}),t.jsx(y,{className:a.askSettingsSeparator,label:"Retrieve this many search results:",min:1,max:50,defaultValue:U.toString(),onChange:Te}),t.jsx(z,{className:a.askSettingsSeparator,label:"Exclude category",onChange:be}),ue&&t.jsx(g,{className:a.askSettingsSeparator,checked:C,label:"Use semantic ranker for retrieval",onChange:fe}),t.jsx(g,{className:a.askSettingsSeparator,checked:O,label:"Use query-contextual summaries instead of whole documents",onChange:ye,disabled:!C}),E&&t.jsx(Me,{gpt4vInputs:F,isUseGPT4V:c,updateUseGPT4V:e=>{ee(e)},updateGPT4VInputs:e=>te(e)}),pe&&t.jsx(Qe,{showImageOptions:c&&E,updateVectorFields:e=>ie(e),updateRetrievalMode:e=>R(e)}),p&&t.jsx(g,{className:a.askSettingsSeparator,checked:I||S,label:"Use oid security filter",disabled:!f(r)||S,onChange:Ae}),p&&t.jsx(g,{className:a.askSettingsSeparator,checked:B||S,label:"Use groups security filter",disabled:!f(r)||S,onChange:Pe}),p&&t.jsx(Le,{})]})]})}it.displayName="Ask";export{it as Component};
//# sourceMappingURL=Ask-c1f9d376.js.map
