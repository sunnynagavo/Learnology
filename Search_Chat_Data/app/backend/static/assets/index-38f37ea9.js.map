{"version":3,"mappings":"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","names":["appServicesAuthTokenUrl","appServicesAuthTokenRefreshUrl","appServicesAuthLogoutUrl","fetchAuthSetup","response","authSetup","useLogin","requireAccessControl","msalConfig","loginRequest","tokenRequest","getRedirectUri","getAppServicesToken","r","json","acc","item","appServicesToken","appServicesLogout","isLoggedIn","client","getToken","error","LoginButton","instance","useMsal","activeAccount","handleLoginPopup","handleLogoutPopup","logoutText","jsx","DefaultButton","styles","Layout","jsxs","Link","NavLink","isActive","Outlet","BACKEND_URI","getHeaders","idToken","configApi","askApi","request","parsedResponse","chatApi","getCitationFilePath","citation","uploadFileApi","deleteUploadedFileApi","filename","listUploadedFilesApi","RetrievalMode","GPT4VInput","VectorFieldOptions","parseAnswerToHtml","answer","isStreaming","onCitationClicked","citations","parsedAnswer","lastIndex","i","part","index","citationIndex","path","renderToStaticMarkup","AnswerIcon","Sparkle28Filled","Answer","isSelected","onThoughtProcessClicked","onSupportingContentClicked","onFollowupQuestionClicked","showFollowupQuestions","followupQuestions","messageContent","useMemo","sanitizedAnswerHtml","DOMPurify","Stack","IconButton","x","AnswerLoading","animatedStyles","useSpring","animated","AnswerError","onRetry","ErrorCircle24Regular","PrimaryButton","QuestionInput","onSend","disabled","placeholder","clearOnSend","initQuestion","question","setQuestion","useState","useEffect","sendQuestion","onEnterPress","ev","onQuestionChange","_ev","newValue","disableRequiredAccessControl","sendQuestionDisabled","TextField","Tooltip","Button","Send28Filled","Example","text","value","onClick","DEFAULT_EXAMPLES","GPT4V_EXAMPLES","ExampleList","onExampleClicked","useGPT4V","UserChatMessage","message","parseSupportingContentItem","parts","title","content","SupportingContent","supportingContent","textItems","imageItems","c","ind","parsed","img","AnalysisPanelTabs","ThoughtProcess","thoughts","t","k","SyntaxHighlighter","MarkdownViewer","src","setContent","isLoading","setIsLoading","setError","removeAnchorLinks","html","ancorLinksRegex","markdownText","parsedHtml","marked","cleanedHtml","Spinner","SpinnerSize","MessageBar","MessageBarType","pivotItemDisabledStyle","AnalysisPanel","activeTab","activeCitation","citationHeight","className","onActiveTabChanged","isDisabledThoughtProcessTab","isDisabledSupportingContentTab","isDisabledCitationTab","setCitation","fetchCitation","token","originalHash","citationContent","citationObjectUrl","renderFileViewer","Pivot","pivotItem","PivotItem","SettingsButton","Settings24Regular","ClearChatButton","Delete24Regular","UploadFile","isCalloutVisible","setIsCalloutVisible","isUploading","setIsUploading","deletionStatus","setDeletionStatus","uploadedFile","setUploadedFile","uploadedFileError","setUploadedFileError","uploadedFiles","setUploadedFiles","handleButtonClick","listUploadedFiles","files","handleRemoveFile","handleUploadFile","e","file","formData","Add24Regular","Callout","Label","Text","vectorFields","VectorSettings","updateRetrievalMode","updateVectorFields","showImageOptions","retrievalMode","setRetrievalMode","vectorFieldOption","setVectorFieldOption","onRetrievalModeChange","option","onVectorFieldsChange","list","Dropdown","ChoiceGroup","TokenClaimsDisplay","ToString","a","items","o","key","originalKey","columns","createTableColumn","b","DataGrid","DataGridHeader","DataGridRow","renderHeaderCell","DataGridHeaderCell","DataGridBody","rowId","renderCell","DataGridCell","GPT4VSettings","updateGPT4VInputs","updateUseGPT4V","isUseGPT4V","gpt4vInputs","setUseGPT4V","onuseGPT4V","checked","onSetGPT4VInput","data","Checkbox","Chat","isConfigPanelOpen","setIsConfigPanelOpen","promptTemplate","setPromptTemplate","temperature","setTemperature","minimumRerankerScore","setMinimumRerankerScore","minimumSearchScore","setMinimumSearchScore","retrieveCount","setRetrieveCount","useSemanticRanker","setUseSemanticRanker","shouldStream","setShouldStream","useSemanticCaptions","setUseSemanticCaptions","excludeCategory","setExcludeCategory","useSuggestFollowupQuestions","setUseSuggestFollowupQuestions","vectorFieldList","setVectorFieldList","useOidSecurityFilter","setUseOidSecurityFilter","useGroupsSecurityFilter","setUseGroupsSecurityFilter","gpt4vInput","setGPT4VInput","lastQuestionRef","useRef","chatMessageStreamEnd","setIsStreaming","setActiveCitation","activeAnalysisPanelTab","setActiveAnalysisPanelTab","selectedAnswer","setSelectedAnswer","answers","setAnswers","streamedAnswers","setStreamedAnswers","showGPT4VOptions","setShowGPT4VOptions","showSemanticRankerOption","setShowSemanticRankerOption","showVectorOption","setShowVectorOption","showUserUpload","setShowUserUpload","getConfig","config","handleAsyncRequest","responseBody","askResponse","updateState","newContent","resolve","latestResponse","event","readNDJSONStream","makeApiRequest","clearChat","onPromptTemplateChange","onTemperatureChange","range","onMinimumSearchScoreChange","onMinimumRerankerScoreChange","onRetrieveCountChange","onUseSemanticRankerChange","onUseSemanticCaptionsChange","onShouldStreamChange","onExcludeCategoryChanged","onUseSuggestFollowupQuestionsChange","onUseOidSecurityFilterChange","onUseGroupsSecurityFilterChange","example","onShowCitation","onToggleTab","tab","streamedAnswer","q","Fragment","SparkleFilled","Panel","Slider","SpinButton","inputs","options","layout","msalInstance","PublicClientApplication","EventType","account","MsalProvider","initializeIcons","router","createHashRouter","__vitePreload","ReactDOM","React","RouterProvider"],"sources":["../../../frontend/src/authConfig.ts","../../../frontend/src/components/LoginButton/LoginButton.tsx","../../../frontend/src/pages/layout/Layout.tsx","../../../frontend/src/api/api.ts","../../../frontend/src/api/models.ts","../../../frontend/src/components/Answer/AnswerParser.tsx","../../../frontend/src/components/Answer/AnswerIcon.tsx","../../../frontend/src/components/Answer/Answer.tsx","../../../frontend/src/components/Answer/AnswerLoading.tsx","../../../frontend/src/components/Answer/AnswerError.tsx","../../../frontend/src/components/QuestionInput/QuestionInput.tsx","../../../frontend/src/components/Example/Example.tsx","../../../frontend/src/components/Example/ExampleList.tsx","../../../frontend/src/components/UserChatMessage/UserChatMessage.tsx","../../../frontend/src/components/SupportingContent/SupportingContentParser.ts","../../../frontend/src/components/SupportingContent/SupportingContent.tsx","../../../frontend/src/components/AnalysisPanel/AnalysisPanelTabs.tsx","../../../frontend/src/components/AnalysisPanel/ThoughtProcess.tsx","../../../frontend/src/components/MarkdownViewer/MarkdownViewer.tsx","../../../frontend/src/components/AnalysisPanel/AnalysisPanel.tsx","../../../frontend/src/components/SettingsButton/SettingsButton.tsx","../../../frontend/src/components/ClearChatButton/ClearChatButton.tsx","../../../frontend/src/components/UploadFile/UploadFile.tsx","../../../frontend/src/components/VectorSettings/VectorSettings.tsx","../../../frontend/src/components/TokenClaimsDisplay/TokenClaimsDisplay.tsx","../../../frontend/src/components/GPT4VSettings/GPT4VSettings.tsx","../../../frontend/src/pages/chat/Chat.tsx","../../../frontend/src/index.tsx"],"sourcesContent":["// Refactored from https://github.com/Azure-Samples/ms-identity-javascript-react-tutorial/blob/main/1-Authentication/1-sign-in/SPA/src/authConfig.js\n\nimport { IPublicClientApplication } from \"@azure/msal-browser\";\n\nconst appServicesAuthTokenUrl = \".auth/me\";\nconst appServicesAuthTokenRefreshUrl = \".auth/refresh\";\nconst appServicesAuthLogoutUrl = \".auth/logout?post_logout_redirect_uri=/\";\n\ninterface AppServicesToken {\n    id_token: string;\n    access_token: string;\n    user_claims: Record<string, any>;\n}\n\ninterface AuthSetup {\n    // Set to true if login elements should be shown in the UI\n    useLogin: boolean;\n    // Set to true if access control is enforced by the application\n    requireAccessControl: boolean;\n    /**\n     * Configuration object to be passed to MSAL instance on creation.\n     * For a full list of MSAL.js configuration parameters, visit:\n     * https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-browser/docs/configuration.md\n     */\n    msalConfig: {\n        auth: {\n            clientId: string; // Client app id used for login\n            authority: string; // Directory to use for login https://learn.microsoft.com/azure/active-directory/develop/msal-client-application-configuration#authority\n            redirectUri: string; // Points to window.location.origin. You must register this URI on Azure Portal/App Registration.\n            postLogoutRedirectUri: string; // Indicates the page to navigate after logout.\n            navigateToLoginRequestUrl: boolean; // If \"true\", will navigate back to the original request location before processing the auth code response.\n        };\n        cache: {\n            cacheLocation: string; // Configures cache location. \"sessionStorage\" is more secure, but \"localStorage\" gives you SSO between tabs.\n            storeAuthStateInCookie: boolean; // Set this to \"true\" if you are having issues on IE11 or Edge\n        };\n    };\n    loginRequest: {\n        /**\n         * Scopes you add here will be prompted for user consent during sign-in.\n         * By default, MSAL.js will add OIDC scopes (openid, profile, email) to any login request.\n         * For more information about OIDC scopes, visit:\n         * https://docs.microsoft.com/azure/active-directory/develop/v2-permissions-and-consent#openid-connect-scopes\n         */\n        scopes: Array<string>;\n    };\n    tokenRequest: {\n        scopes: Array<string>;\n    };\n}\n\n// Fetch the auth setup JSON data from the API if not already cached\nasync function fetchAuthSetup(): Promise<AuthSetup> {\n    const response = await fetch(\"/auth_setup\");\n    if (!response.ok) {\n        throw new Error(`auth setup response was not ok: ${response.status}`);\n    }\n    return await response.json();\n}\n\nconst authSetup = await fetchAuthSetup();\n\nexport const useLogin = authSetup.useLogin;\n\nexport const requireAccessControl = authSetup.requireAccessControl;\n\n/**\n * Configuration object to be passed to MSAL instance on creation.\n * For a full list of MSAL.js configuration parameters, visit:\n * https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-browser/docs/configuration.md\n */\nexport const msalConfig = authSetup.msalConfig;\n\n/**\n * Scopes you add here will be prompted for user consent during sign-in.\n * By default, MSAL.js will add OIDC scopes (openid, profile, email) to any login request.\n * For more information about OIDC scopes, visit:\n * https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-permissions-and-consent#openid-connect-scopes\n */\nexport const loginRequest = authSetup.loginRequest;\n\nconst tokenRequest = authSetup.tokenRequest;\n\n// Build an absolute redirect URI using the current window's location and the relative redirect URI from auth setup\nexport const getRedirectUri = () => {\n    return window.location.origin + authSetup.msalConfig.auth.redirectUri;\n};\n\n// Get an access token if a user logged in using app services authentication\n// Returns null if the app doesn't support app services authentication\nconst getAppServicesToken = (): Promise<AppServicesToken | null> => {\n    return fetch(appServicesAuthTokenRefreshUrl).then(r => {\n        if (r.ok) {\n            return fetch(appServicesAuthTokenUrl).then(r => {\n                if (r.ok) {\n                    return r.json().then(json => {\n                        if (json.length > 0) {\n                            return {\n                                id_token: json[0][\"id_token\"] as string,\n                                access_token: json[0][\"access_token\"] as string,\n                                user_claims: json[0][\"user_claims\"].reduce((acc: Record<string, any>, item: Record<string, any>) => {\n                                    acc[item.typ] = item.val;\n                                    return acc;\n                                }, {}) as Record<string, any>\n                            };\n                        }\n\n                        return null;\n                    });\n                }\n\n                return null;\n            });\n        }\n\n        return null;\n    });\n};\n\nexport const appServicesToken = await getAppServicesToken();\n\n// Sign out of app services\n// Learn more at https://learn.microsoft.com/azure/app-service/configure-authentication-customize-sign-in-out#sign-out-of-a-session\nexport const appServicesLogout = () => {\n    window.location.href = appServicesAuthLogoutUrl;\n};\n\n// Determine if the user is logged in\n// The user may have logged in either using the app services login or the on-page login\nexport const isLoggedIn = (client: IPublicClientApplication | undefined): boolean => {\n    return client?.getActiveAccount() != null || appServicesToken != null;\n};\n\n// Get an access token for use with the API server.\n// ID token received when logging in may not be used for this purpose because it has the incorrect audience\n// Use the access token from app services login if available\nexport const getToken = (client: IPublicClientApplication): Promise<string | undefined> => {\n    if (appServicesToken) {\n        return Promise.resolve(appServicesToken.access_token);\n    }\n\n    return client\n        .acquireTokenSilent({\n            ...tokenRequest,\n            redirectUri: getRedirectUri()\n        })\n        .then(r => r.accessToken)\n        .catch(error => {\n            console.log(error);\n            return undefined;\n        });\n};\n","import { DefaultButton } from \"@fluentui/react\";\nimport { useMsal } from \"@azure/msal-react\";\n\nimport styles from \"./LoginButton.module.css\";\nimport { getRedirectUri, loginRequest } from \"../../authConfig\";\nimport { appServicesToken, appServicesLogout } from \"../../authConfig\";\n\nexport const LoginButton = () => {\n    const { instance } = useMsal();\n    const activeAccount = instance.getActiveAccount();\n    const isLoggedIn = (activeAccount || appServicesToken) != null;\n\n    const handleLoginPopup = () => {\n        /**\n         * When using popup and silent APIs, we recommend setting the redirectUri to a blank page or a page\n         * that does not implement MSAL. Keep in mind that all redirect routes must be registered with the application\n         * For more information, please follow this link: https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-browser/docs/login-user.md#redirecturi-considerations\n         */\n        instance\n            .loginPopup({\n                ...loginRequest,\n                redirectUri: getRedirectUri()\n            })\n            .catch(error => console.log(error));\n    };\n    const handleLogoutPopup = () => {\n        if (activeAccount) {\n            instance\n                .logoutPopup({\n                    mainWindowRedirectUri: \"/\", // redirects the top level app after logout\n                    account: instance.getActiveAccount()\n                })\n                .catch(error => console.log(error));\n        } else {\n            appServicesLogout();\n        }\n    };\n    const logoutText = `Logout\\n${activeAccount?.username ?? appServicesToken?.user_claims?.preferred_username}`;\n    return (\n        <DefaultButton\n            text={isLoggedIn ? logoutText : \"Login\"}\n            className={styles.loginButton}\n            onClick={isLoggedIn ? handleLogoutPopup : handleLoginPopup}\n        ></DefaultButton>\n    );\n};\n","import { Outlet, NavLink, Link } from \"react-router-dom\";\n\nimport styles from \"./Layout.module.css\";\n\nimport { useLogin } from \"../../authConfig\";\n\nimport { LoginButton } from \"../../components/LoginButton\";\n\nconst Layout = () => {\n    return (\n        <div className={styles.layout}>\n            <header className={styles.header} role={\"banner\"}>\n                <div className={styles.headerContainer}>\n                    <Link to=\"/\" className={styles.headerTitleContainer}>\n                        <h3 className={styles.headerTitle}>Learntology</h3>\n                    </Link>\n                    <nav>\n                        <ul className={styles.headerNavList}>\n                            <li>\n                                <NavLink to=\"/\" className={({ isActive }) => (isActive ? styles.headerNavPageLinkActive : styles.headerNavPageLink)}>\n                                    Chat\n                                </NavLink>\n                            </li>\n                            <li className={styles.headerNavLeftMargin}></li>\n                        </ul>\n                    </nav>\n                    <h4 className={styles.headerRightText}>Learn python through chatting</h4>\n                    {useLogin && <LoginButton />}\n                </div>\n            </header>\n\n            <Outlet />\n        </div>\n    );\n};\n\nexport default Layout;\n","const BACKEND_URI = \"\";\n\nimport { ChatAppResponse, ChatAppResponseOrError, ChatAppRequest, Config, SimpleAPIResponse } from \"./models\";\nimport { useLogin, appServicesToken } from \"../authConfig\";\n\nexport function getHeaders(idToken: string | undefined): Record<string, string> {\n    // If using login and not using app services, add the id token of the logged in account as the authorization\n    if (useLogin && appServicesToken == null) {\n        if (idToken) {\n            return { Authorization: `Bearer ${idToken}` };\n        }\n    }\n\n    return {};\n}\n\nexport async function configApi(): Promise<Config> {\n    const response = await fetch(`${BACKEND_URI}/config`, {\n        method: \"GET\"\n    });\n\n    return (await response.json()) as Config;\n}\n\nexport async function askApi(request: ChatAppRequest, idToken: string | undefined): Promise<ChatAppResponse> {\n    const response = await fetch(`${BACKEND_URI}/ask`, {\n        method: \"POST\",\n        headers: { ...getHeaders(idToken), \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(request)\n    });\n\n    const parsedResponse: ChatAppResponseOrError = await response.json();\n    if (response.status > 299 || !response.ok) {\n        throw Error(parsedResponse.error || \"Unknown error\");\n    }\n\n    return parsedResponse as ChatAppResponse;\n}\n\nexport async function chatApi(request: ChatAppRequest, idToken: string | undefined): Promise<Response> {\n    return await fetch(`${BACKEND_URI}/chat`, {\n        method: \"POST\",\n        headers: { ...getHeaders(idToken), \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(request)\n    });\n}\n\nexport function getCitationFilePath(citation: string): string {\n    return `${BACKEND_URI}/content/${citation}`;\n}\n\nexport async function uploadFileApi(request: FormData, idToken: string): Promise<SimpleAPIResponse> {\n    const response = await fetch(\"/upload\", {\n        method: \"POST\",\n        headers: getHeaders(idToken),\n        body: request\n    });\n\n    if (!response.ok) {\n        throw new Error(`Uploading files failed: ${response.statusText}`);\n    }\n\n    const dataResponse: SimpleAPIResponse = await response.json();\n    return dataResponse;\n}\n\nexport async function deleteUploadedFileApi(filename: string, idToken: string): Promise<SimpleAPIResponse> {\n    const response = await fetch(\"/delete_uploaded\", {\n        method: \"POST\",\n        headers: { ...getHeaders(idToken), \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ filename })\n    });\n\n    if (!response.ok) {\n        throw new Error(`Deleting file failed: ${response.statusText}`);\n    }\n\n    const dataResponse: SimpleAPIResponse = await response.json();\n    return dataResponse;\n}\n\nexport async function listUploadedFilesApi(idToken: string): Promise<string[]> {\n    const response = await fetch(`/list_uploaded`, {\n        method: \"GET\",\n        headers: getHeaders(idToken)\n    });\n\n    if (!response.ok) {\n        throw new Error(`Listing files failed: ${response.statusText}`);\n    }\n\n    const dataResponse: string[] = await response.json();\n    return dataResponse;\n}\n","export const enum RetrievalMode {\n    Hybrid = \"hybrid\",\n    Vectors = \"vectors\",\n    Text = \"text\"\n}\n\nexport const enum GPT4VInput {\n    TextAndImages = \"textAndImages\",\n    Images = \"images\",\n    Texts = \"texts\"\n}\n\nexport const enum VectorFieldOptions {\n    Embedding = \"embedding\",\n    ImageEmbedding = \"imageEmbedding\",\n    Both = \"both\"\n}\n\nexport type ChatAppRequestOverrides = {\n    retrieval_mode?: RetrievalMode;\n    semantic_ranker?: boolean;\n    semantic_captions?: boolean;\n    exclude_category?: string;\n    top?: number;\n    temperature?: number;\n    minimum_search_score?: number;\n    minimum_reranker_score?: number;\n    prompt_template?: string;\n    prompt_template_prefix?: string;\n    prompt_template_suffix?: string;\n    suggest_followup_questions?: boolean;\n    use_oid_security_filter?: boolean;\n    use_groups_security_filter?: boolean;\n    use_gpt4v?: boolean;\n    gpt4v_input?: GPT4VInput;\n    vector_fields: VectorFieldOptions[];\n};\n\nexport type ResponseMessage = {\n    content: string;\n    role: string;\n};\n\nexport type Thoughts = {\n    title: string;\n    description: any; // It can be any output from the api\n    props?: { [key: string]: string };\n};\n\nexport type ResponseContext = {\n    data_points: string[];\n    followup_questions: string[] | null;\n    thoughts: Thoughts[];\n};\n\nexport type ResponseChoice = {\n    index: number;\n    message: ResponseMessage;\n    context: ResponseContext;\n    session_state: any;\n};\n\nexport type ChatAppResponseOrError = {\n    choices?: ResponseChoice[];\n    error?: string;\n};\n\nexport type ChatAppResponse = {\n    choices: ResponseChoice[];\n};\n\nexport type ChatAppRequestContext = {\n    overrides?: ChatAppRequestOverrides;\n};\n\nexport type ChatAppRequest = {\n    messages: ResponseMessage[];\n    context?: ChatAppRequestContext;\n    stream?: boolean;\n    session_state: any;\n};\n\nexport type Config = {\n    showGPT4VOptions: boolean;\n    showSemanticRankerOption: boolean;\n    showVectorOption: boolean;\n    showUserUpload: boolean;\n};\n\nexport type SimpleAPIResponse = {\n    message?: string;\n};\n","import { renderToStaticMarkup } from \"react-dom/server\";\nimport { getCitationFilePath } from \"../../api\";\n\ntype HtmlParsedAnswer = {\n    answerHtml: string;\n    citations: string[];\n};\n\nexport function parseAnswerToHtml(answer: string, isStreaming: boolean, onCitationClicked: (citationFilePath: string) => void): HtmlParsedAnswer {\n    const citations: string[] = [];\n\n    // trim any whitespace from the end of the answer after removing follow-up questions\n    let parsedAnswer = answer.trim();\n\n    // Omit a citation that is still being typed during streaming\n    if (isStreaming) {\n        let lastIndex = parsedAnswer.length;\n        for (let i = parsedAnswer.length - 1; i >= 0; i--) {\n            if (parsedAnswer[i] === \"]\") {\n                break;\n            } else if (parsedAnswer[i] === \"[\") {\n                lastIndex = i;\n                break;\n            }\n        }\n        const truncatedAnswer = parsedAnswer.substring(0, lastIndex);\n        parsedAnswer = truncatedAnswer;\n    }\n\n    const parts = parsedAnswer.split(/\\[([^\\]]+)\\]/g);\n\n    const fragments: string[] = parts.map((part, index) => {\n        if (index % 2 === 0) {\n            return part;\n        } else {\n            let citationIndex: number;\n            if (citations.indexOf(part) !== -1) {\n                citationIndex = citations.indexOf(part) + 1;\n            } else {\n                citations.push(part);\n                citationIndex = citations.length;\n            }\n\n            const path = getCitationFilePath(part);\n\n            return renderToStaticMarkup(\n                <a className=\"supContainer\" title={part} onClick={() => onCitationClicked(path)}>\n                    <sup>{citationIndex}</sup>\n                </a>\n            );\n        }\n    });\n\n    return {\n        answerHtml: fragments.join(\"\"),\n        citations\n    };\n}\n","import { Sparkle28Filled } from \"@fluentui/react-icons\";\n\nexport const AnswerIcon = () => {\n    return <Sparkle28Filled primaryFill={\"rgba(115, 118, 225, 1)\"} aria-hidden=\"true\" aria-label=\"Answer logo\" />;\n};\n","import { useMemo } from \"react\";\nimport { Stack, IconButton } from \"@fluentui/react\";\nimport DOMPurify from \"dompurify\";\n\nimport styles from \"./Answer.module.css\";\n\nimport { ChatAppResponse, getCitationFilePath } from \"../../api\";\nimport { parseAnswerToHtml } from \"./AnswerParser\";\nimport { AnswerIcon } from \"./AnswerIcon\";\n\ninterface Props {\n    answer: ChatAppResponse;\n    isSelected?: boolean;\n    isStreaming: boolean;\n    onCitationClicked: (filePath: string) => void;\n    onThoughtProcessClicked: () => void;\n    onSupportingContentClicked: () => void;\n    onFollowupQuestionClicked?: (question: string) => void;\n    showFollowupQuestions?: boolean;\n}\n\nexport const Answer = ({\n    answer,\n    isSelected,\n    isStreaming,\n    onCitationClicked,\n    onThoughtProcessClicked,\n    onSupportingContentClicked,\n    onFollowupQuestionClicked,\n    showFollowupQuestions\n}: Props) => {\n    const followupQuestions = answer.choices[0].context.followup_questions;\n    const messageContent = answer.choices[0].message.content;\n    const parsedAnswer = useMemo(() => parseAnswerToHtml(messageContent, isStreaming, onCitationClicked), [answer]);\n\n    const sanitizedAnswerHtml = DOMPurify.sanitize(parsedAnswer.answerHtml);\n\n    return (\n        <Stack className={`${styles.answerContainer} ${isSelected && styles.selected}`} verticalAlign=\"space-between\">\n            <Stack.Item>\n                <Stack horizontal horizontalAlign=\"space-between\">\n                    <AnswerIcon />\n                    <div>\n                        <IconButton\n                            style={{ color: \"black\" }}\n                            iconProps={{ iconName: \"Lightbulb\" }}\n                            title=\"Show thought process\"\n                            ariaLabel=\"Show thought process\"\n                            onClick={() => onThoughtProcessClicked()}\n                            disabled={!answer.choices[0].context.thoughts?.length}\n                        />\n                        <IconButton\n                            style={{ color: \"black\" }}\n                            iconProps={{ iconName: \"ClipboardList\" }}\n                            title=\"Show supporting content\"\n                            ariaLabel=\"Show supporting content\"\n                            onClick={() => onSupportingContentClicked()}\n                            disabled={!answer.choices[0].context.data_points}\n                        />\n                    </div>\n                </Stack>\n            </Stack.Item>\n\n            <Stack.Item grow>\n                <div className={styles.answerText} dangerouslySetInnerHTML={{ __html: sanitizedAnswerHtml }}></div>\n            </Stack.Item>\n\n            {!!parsedAnswer.citations.length && (\n                <Stack.Item>\n                    <Stack horizontal wrap tokens={{ childrenGap: 5 }}>\n                        <span className={styles.citationLearnMore}>Citations:</span>\n                        {parsedAnswer.citations.map((x, i) => {\n                            const path = getCitationFilePath(x);\n                            return (\n                                <a key={i} className={styles.citation} title={x} onClick={() => onCitationClicked(path)}>\n                                    {`${++i}. ${x}`}\n                                </a>\n                            );\n                        })}\n                    </Stack>\n                </Stack.Item>\n            )}\n\n            {!!followupQuestions?.length && showFollowupQuestions && onFollowupQuestionClicked && (\n                <Stack.Item>\n                    <Stack horizontal wrap className={`${!!parsedAnswer.citations.length ? styles.followupQuestionsList : \"\"}`} tokens={{ childrenGap: 6 }}>\n                        <span className={styles.followupQuestionLearnMore}>Follow-up questions:</span>\n                        {followupQuestions.map((x, i) => {\n                            return (\n                                <a key={i} className={styles.followupQuestion} title={x} onClick={() => onFollowupQuestionClicked(x)}>\n                                    {`${x}`}\n                                </a>\n                            );\n                        })}\n                    </Stack>\n                </Stack.Item>\n            )}\n        </Stack>\n    );\n};\n","import { Stack } from \"@fluentui/react\";\nimport { animated, useSpring } from \"@react-spring/web\";\n\nimport styles from \"./Answer.module.css\";\nimport { AnswerIcon } from \"./AnswerIcon\";\n\nexport const AnswerLoading = () => {\n    const animatedStyles = useSpring({\n        from: { opacity: 0 },\n        to: { opacity: 1 }\n    });\n\n    return (\n        <animated.div style={{ ...animatedStyles }}>\n            <Stack className={styles.answerContainer} verticalAlign=\"space-between\">\n                <AnswerIcon />\n                <Stack.Item grow>\n                    <p className={styles.answerText}>\n                        Generating answer\n                        <span className={styles.loadingdots} />\n                    </p>\n                </Stack.Item>\n            </Stack>\n        </animated.div>\n    );\n};\n","import { Stack, PrimaryButton } from \"@fluentui/react\";\nimport { ErrorCircle24Regular } from \"@fluentui/react-icons\";\n\nimport styles from \"./Answer.module.css\";\n\ninterface Props {\n    error: string;\n    onRetry: () => void;\n}\n\nexport const AnswerError = ({ error, onRetry }: Props) => {\n    return (\n        <Stack className={styles.answerContainer} verticalAlign=\"space-between\">\n            <ErrorCircle24Regular aria-hidden=\"true\" aria-label=\"Error icon\" primaryFill=\"red\" />\n\n            <Stack.Item grow>\n                <p className={styles.answerText}>{error}</p>\n            </Stack.Item>\n\n            <PrimaryButton className={styles.retryButton} onClick={onRetry} text=\"Retry\" />\n        </Stack>\n    );\n};\n","import { useEffect, useState } from \"react\";\nimport { useMsal } from \"@azure/msal-react\";\nimport { Stack, TextField } from \"@fluentui/react\";\nimport { Button, Tooltip, Field, Textarea } from \"@fluentui/react-components\";\nimport { Send28Filled } from \"@fluentui/react-icons\";\nimport { isLoggedIn, requireAccessControl } from \"../../authConfig\";\n\nimport styles from \"./QuestionInput.module.css\";\n\ninterface Props {\n    onSend: (question: string) => void;\n    disabled: boolean;\n    initQuestion?: string;\n    placeholder?: string;\n    clearOnSend?: boolean;\n}\n\nexport const QuestionInput = ({ onSend, disabled, placeholder, clearOnSend, initQuestion }: Props) => {\n    const [question, setQuestion] = useState<string>(\"\");\n\n    useEffect(() => {\n        initQuestion && setQuestion(initQuestion);\n    }, [initQuestion]);\n\n    const sendQuestion = () => {\n        if (disabled || !question.trim()) {\n            return;\n        }\n\n        onSend(question);\n\n        if (clearOnSend) {\n            setQuestion(\"\");\n        }\n    };\n\n    const onEnterPress = (ev: React.KeyboardEvent<Element>) => {\n        if (ev.key === \"Enter\" && !ev.shiftKey) {\n            ev.preventDefault();\n            sendQuestion();\n        }\n    };\n\n    const onQuestionChange = (_ev: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\n        if (!newValue) {\n            setQuestion(\"\");\n        } else if (newValue.length <= 1000) {\n            setQuestion(newValue);\n        }\n    };\n\n    const { instance } = useMsal();\n    const disableRequiredAccessControl = requireAccessControl && !isLoggedIn(instance);\n    const sendQuestionDisabled = disabled || !question.trim() || disableRequiredAccessControl;\n\n    if (disableRequiredAccessControl) {\n        placeholder = \"Please login to continue...\";\n    }\n\n    return (\n        <Stack horizontal className={styles.questionInputContainer}>\n            <TextField\n                className={styles.questionInputTextArea}\n                disabled={disableRequiredAccessControl}\n                placeholder={placeholder}\n                multiline\n                resizable={false}\n                borderless\n                value={question}\n                onChange={onQuestionChange}\n                onKeyDown={onEnterPress}\n            />\n            <div className={styles.questionInputButtonsContainer}>\n                <Tooltip content=\"Ask question button\" relationship=\"label\">\n                    <Button size=\"large\" icon={<Send28Filled primaryFill=\"rgba(115, 118, 225, 1)\" />} disabled={sendQuestionDisabled} onClick={sendQuestion} />\n                </Tooltip>\n            </div>\n        </Stack>\n    );\n};\n","import styles from \"./Example.module.css\";\n\ninterface Props {\n    text: string;\n    value: string;\n    onClick: (value: string) => void;\n}\n\nexport const Example = ({ text, value, onClick }: Props) => {\n    return (\n        <div className={styles.example} onClick={() => onClick(value)}>\n            <p className={styles.exampleText}>{text}</p>\n        </div>\n    );\n};\n","import { Example } from \"./Example\";\n\nimport styles from \"./Example.module.css\";\n\nconst DEFAULT_EXAMPLES: string[] = [\n    \"What is Python?\",\n    \"How to write a function?\",\n    \"How to write a loop?\"\n];\n\nconst GPT4V_EXAMPLES: string[] = [\n    \"List Values and types of python\",\n    \"What are assignment statements in python?\",\n    \"List string operations of python?\"\n];\n\ninterface Props {\n    onExampleClicked: (value: string) => void;\n    useGPT4V?: boolean;\n}\n\nexport const ExampleList = ({ onExampleClicked, useGPT4V }: Props) => {\n    return (\n        <ul className={styles.examplesNavList}>\n            {(useGPT4V ? GPT4V_EXAMPLES : DEFAULT_EXAMPLES).map((question, i) => (\n                <li key={i}>\n                    <Example text={question} value={question} onClick={onExampleClicked} />\n                </li>\n            ))}\n        </ul>\n    );\n};\n","import styles from \"./UserChatMessage.module.css\";\n\ninterface Props {\n    message: string;\n}\n\nexport const UserChatMessage = ({ message }: Props) => {\n    return (\n        <div className={styles.container}>\n            <div className={styles.message}>{message}</div>\n        </div>\n    );\n};\n","import DOMPurify from \"dompurify\";\n\ntype ParsedSupportingContentItem = {\n    title: string;\n    content: string;\n};\n\nexport function parseSupportingContentItem(item: string): ParsedSupportingContentItem {\n    // Assumes the item starts with the file name followed by : and the content.\n    // Example: \"sdp_corporate.pdf: this is the content that follows\".\n    const parts = item.split(\": \");\n    const title = parts[0];\n    const content = DOMPurify.sanitize(parts.slice(1).join(\": \"));\n\n    return {\n        title,\n        content\n    };\n}\n","import { parseSupportingContentItem } from \"./SupportingContentParser\";\n\nimport styles from \"./SupportingContent.module.css\";\n\ninterface Props {\n    supportingContent: string[] | { text: string[]; images?: { url: string }[] };\n}\n\nexport const SupportingContent = ({ supportingContent }: Props) => {\n    const textItems = Array.isArray(supportingContent) ? supportingContent : supportingContent.text;\n    const imageItems = !Array.isArray(supportingContent) ? supportingContent?.images : [];\n    return (\n        <ul className={styles.supportingContentNavList}>\n            {textItems.map((c, ind) => {\n                const parsed = parseSupportingContentItem(c);\n                return (\n                    <li className={styles.supportingContentItem} key={ind}>\n                        <h4 className={styles.supportingContentItemHeader}>{parsed.title}</h4>\n                        <p className={styles.supportingContentItemText} dangerouslySetInnerHTML={{ __html: parsed.content }} />\n                    </li>\n                );\n            })}\n            {imageItems?.map((img, ind) => {\n                return <img className={styles.supportingContentItemImage} src={img.url} key={ind} />;\n            })}\n        </ul>\n    );\n};\n","export enum AnalysisPanelTabs {\n    ThoughtProcessTab = \"thoughtProcess\",\n    SupportingContentTab = \"supportingContent\",\n    CitationTab = \"citation\"\n}\n","import { Stack } from \"@fluentui/react\";\nimport SyntaxHighlighter from \"react-syntax-highlighter\";\n\nimport styles from \"./AnalysisPanel.module.css\";\n\nimport { Thoughts } from \"../../api\";\n\ninterface Props {\n    thoughts: Thoughts[];\n}\n\nexport const ThoughtProcess = ({ thoughts }: Props) => {\n    return (\n        <ul className={styles.tList}>\n            {thoughts.map((t, ind) => {\n                return (\n                    <li className={styles.tListItem} key={ind}>\n                        <div className={styles.tStep}>{t.title}</div>\n                        <Stack horizontal tokens={{ childrenGap: 5 }}>\n                            {t.props &&\n                                (Object.keys(t.props) || []).map((k: any) => (\n                                    <span className={styles.tProp}>\n                                        {k}: {JSON.stringify(t.props?.[k])}\n                                    </span>\n                                ))}\n                        </Stack>\n                        {Array.isArray(t.description) ? (\n                            <SyntaxHighlighter language=\"json\" wrapLongLines className={styles.tCodeBlock}>\n                                {JSON.stringify(t.description, null, 2)}\n                            </SyntaxHighlighter>\n                        ) : (\n                            <div>{t.description}</div>\n                        )}\n                    </li>\n                );\n            })}\n        </ul>\n    );\n};\n","import React, { useState, useEffect } from \"react\";\nimport { marked } from \"marked\";\nimport styles from \"./MarkdownViewer.module.css\";\nimport { Spinner, SpinnerSize, MessageBar, MessageBarType, Link, IconButton } from \"@fluentui/react\";\n\ninterface MarkdownViewerProps {\n    src: string;\n}\n\nexport const MarkdownViewer: React.FC<MarkdownViewerProps> = ({ src }) => {\n    const [content, setContent] = useState<string>(\"\");\n    const [isLoading, setIsLoading] = useState<boolean>(true);\n    const [error, setError] = useState<Error | null>(null);\n\n    /**\n     * Anchor links are not handled well by 'marked' and result in HTTP 404 errors as the URL they point to does not exist.\n     * This function removes them from the resulted HTML.\n     */\n    const removeAnchorLinks = (html: string) => {\n        const ancorLinksRegex = /<a\\s+(?:[^>]*?\\s+)?href=['\"](#[^\"']*?)['\"][^>]*?>/g;\n        return html.replace(ancorLinksRegex, \"\");\n    };\n\n    useEffect(() => {\n        const fetchMarkdown = async () => {\n            try {\n                const response = await fetch(src);\n\n                if (!response.ok) {\n                    throw new Error(\"Failed loading markdown file.\");\n                }\n\n                const markdownText = await response.text();\n                const parsedHtml = await marked.parse(markdownText);\n                const cleanedHtml = removeAnchorLinks(parsedHtml);\n                setContent(cleanedHtml);\n            } catch (error: any) {\n                setError(error);\n            } finally {\n                setIsLoading(false);\n            }\n        };\n\n        fetchMarkdown();\n    }, [src]);\n\n    return (\n        <div>\n            {isLoading ? (\n                <div className={`${styles.loading} ${styles.markdownViewer}`}>\n                    <Spinner size={SpinnerSize.large} label=\"Loading file\" />\n                </div>\n            ) : error ? (\n                <div className={`${styles.error} ${styles.markdownViewer}`}>\n                    <MessageBar messageBarType={MessageBarType.error} isMultiline={false}>\n                        {error.message}\n                        <Link href={src} download>\n                            Download the file\n                        </Link>\n                    </MessageBar>\n                </div>\n            ) : (\n                <div>\n                    <IconButton\n                        className={styles.downloadButton}\n                        style={{ color: \"black\" }}\n                        iconProps={{ iconName: \"Save\" }}\n                        title=\"Save\"\n                        ariaLabel=\"Save\"\n                        href={src}\n                        download\n                    />\n                    <div className={`${styles.markdown} ${styles.markdownViewer}`} dangerouslySetInnerHTML={{ __html: content }} />\n                </div>\n            )}\n        </div>\n    );\n};\n","import { Stack, Pivot, PivotItem } from \"@fluentui/react\";\n\nimport styles from \"./AnalysisPanel.module.css\";\n\nimport { SupportingContent } from \"../SupportingContent\";\nimport { ChatAppResponse } from \"../../api\";\nimport { AnalysisPanelTabs } from \"./AnalysisPanelTabs\";\nimport { ThoughtProcess } from \"./ThoughtProcess\";\nimport { MarkdownViewer } from \"../MarkdownViewer\";\nimport { useMsal } from \"@azure/msal-react\";\nimport { getHeaders } from \"../../api\";\nimport { useLogin, getToken } from \"../../authConfig\";\nimport { useState, useEffect } from \"react\";\n\ninterface Props {\n    className: string;\n    activeTab: AnalysisPanelTabs;\n    onActiveTabChanged: (tab: AnalysisPanelTabs) => void;\n    activeCitation: string | undefined;\n    citationHeight: string;\n    answer: ChatAppResponse;\n}\n\nconst pivotItemDisabledStyle = { disabled: true, style: { color: \"grey\" } };\n\nexport const AnalysisPanel = ({ answer, activeTab, activeCitation, citationHeight, className, onActiveTabChanged }: Props) => {\n    const isDisabledThoughtProcessTab: boolean = !answer.choices[0].context.thoughts;\n    const isDisabledSupportingContentTab: boolean = !answer.choices[0].context.data_points;\n    const isDisabledCitationTab: boolean = !activeCitation;\n    const [citation, setCitation] = useState(\"\");\n\n    const client = useLogin ? useMsal().instance : undefined;\n\n    const fetchCitation = async () => {\n        const token = client ? await getToken(client) : undefined;\n        if (activeCitation) {\n            // Get hash from the URL as it may contain #page=N\n            // which helps browser PDF renderer jump to correct page N\n            const originalHash = activeCitation.indexOf(\"#\") ? activeCitation.split(\"#\")[1] : \"\";\n            const response = await fetch(activeCitation, {\n                method: \"GET\",\n                headers: getHeaders(token)\n            });\n            const citationContent = await response.blob();\n            let citationObjectUrl = URL.createObjectURL(citationContent);\n            // Add hash back to the new blob URL\n            if (originalHash) {\n                citationObjectUrl += \"#\" + originalHash;\n            }\n            setCitation(citationObjectUrl);\n        }\n    };\n    useEffect(() => {\n        fetchCitation();\n    }, []);\n\n    const renderFileViewer = () => {\n        if (!activeCitation) {\n            return null;\n        }\n\n        const fileExtension = activeCitation.split(\".\").pop()?.toLowerCase();\n        switch (fileExtension) {\n            case \"png\":\n                return <img src={citation} className={styles.citationImg} alt=\"Citation Image\" />;\n            case \"md\":\n                return <MarkdownViewer src={activeCitation} />;\n            default:\n                return <iframe title=\"Citation\" src={citation} width=\"100%\" height={citationHeight} />;\n        }\n    };\n\n    return (\n        <Pivot\n            className={className}\n            selectedKey={activeTab}\n            onLinkClick={pivotItem => pivotItem && onActiveTabChanged(pivotItem.props.itemKey! as AnalysisPanelTabs)}\n        >\n            <PivotItem\n                itemKey={AnalysisPanelTabs.ThoughtProcessTab}\n                headerText=\"Thought process\"\n                headerButtonProps={isDisabledThoughtProcessTab ? pivotItemDisabledStyle : undefined}\n            >\n                <ThoughtProcess thoughts={answer.choices[0].context.thoughts || []} />\n            </PivotItem>\n            <PivotItem\n                itemKey={AnalysisPanelTabs.SupportingContentTab}\n                headerText=\"Supporting content\"\n                headerButtonProps={isDisabledSupportingContentTab ? pivotItemDisabledStyle : undefined}\n            >\n                <SupportingContent supportingContent={answer.choices[0].context.data_points} />\n            </PivotItem>\n            <PivotItem\n                itemKey={AnalysisPanelTabs.CitationTab}\n                headerText=\"Citation\"\n                headerButtonProps={isDisabledCitationTab ? pivotItemDisabledStyle : undefined}\n            >\n                {renderFileViewer()}\n            </PivotItem>\n        </Pivot>\n    );\n};\n","import { Settings24Regular } from \"@fluentui/react-icons\";\nimport { Button } from \"@fluentui/react-components\";\n\nimport styles from \"./SettingsButton.module.css\";\n\ninterface Props {\n    className?: string;\n    onClick: () => void;\n}\n\nexport const SettingsButton = ({ className, onClick }: Props) => {\n    return (\n        <div className={`${styles.container} ${className ?? \"\"}`}>\n            <Button icon={<Settings24Regular />} onClick={onClick}>\n                {\"Developer settings\"}\n            </Button>\n        </div>\n    );\n};\n","import { Delete24Regular } from \"@fluentui/react-icons\";\nimport { Button } from \"@fluentui/react-components\";\n\nimport styles from \"./ClearChatButton.module.css\";\n\ninterface Props {\n    className?: string;\n    onClick: () => void;\n    disabled?: boolean;\n}\n\nexport const ClearChatButton = ({ className, disabled, onClick }: Props) => {\n    return (\n        <div className={`${styles.container} ${className ?? \"\"}`}>\n            <Button icon={<Delete24Regular />} disabled={disabled} onClick={onClick}>\n                {\"Clear chat\"}\n            </Button>\n        </div>\n    );\n};\n","import React, { useState, ChangeEvent } from \"react\";\nimport { Callout, Label, Text } from \"@fluentui/react\";\nimport { Button } from \"@fluentui/react-components\";\nimport { Add24Regular, Delete24Regular } from \"@fluentui/react-icons\";\nimport { useMsal } from \"@azure/msal-react\";\n\nimport { SimpleAPIResponse, uploadFileApi, deleteUploadedFileApi, listUploadedFilesApi } from \"../../api\";\nimport { useLogin, getToken } from \"../../authConfig\";\nimport styles from \"./UploadFile.module.css\";\n\ninterface Props {\n    className?: string;\n    disabled?: boolean;\n}\n\nexport const UploadFile: React.FC<Props> = ({ className, disabled }: Props) => {\n    // State variables to manage the component behavior\n    const [isCalloutVisible, setIsCalloutVisible] = useState<boolean>(false);\n    const [isUploading, setIsUploading] = useState<boolean>(false);\n    const [isLoading, setIsLoading] = useState<boolean>(true);\n    const [deletionStatus, setDeletionStatus] = useState<{ [filename: string]: \"pending\" | \"error\" | \"success\" }>({});\n    const [uploadedFile, setUploadedFile] = useState<SimpleAPIResponse>();\n    const [uploadedFileError, setUploadedFileError] = useState<string>();\n    const [uploadedFiles, setUploadedFiles] = useState<string[]>([]);\n\n    if (!useLogin) {\n        throw new Error(\"The UploadFile component requires useLogin to be true\");\n    }\n\n    const client = useMsal().instance;\n\n    // Handler for the \"Manage file uploads\" button\n    const handleButtonClick = async () => {\n        setIsCalloutVisible(!isCalloutVisible); // Toggle the Callout visibility\n\n        // Update uploaded files by calling the API\n        try {\n            const idToken = await getToken(client);\n            if (!idToken) {\n                throw new Error(\"No authentication token available\");\n            }\n            listUploadedFiles(idToken);\n        } catch (error) {\n            console.error(error);\n            setIsLoading(false);\n        }\n    };\n\n    const listUploadedFiles = async (idToken: string) => {\n        listUploadedFilesApi(idToken).then(files => {\n            setIsLoading(false);\n            setDeletionStatus({});\n            setUploadedFiles(files);\n        });\n    };\n\n    const handleRemoveFile = async (filename: string) => {\n        setDeletionStatus({ ...deletionStatus, [filename]: \"pending\" });\n\n        try {\n            const idToken = await getToken(client);\n            if (!idToken) {\n                throw new Error(\"No authentication token available\");\n            }\n\n            await deleteUploadedFileApi(filename, idToken);\n            setDeletionStatus({ ...deletionStatus, [filename]: \"success\" });\n            listUploadedFiles(idToken);\n        } catch (error) {\n            setDeletionStatus({ ...deletionStatus, [filename]: \"error\" });\n            console.error(error);\n        }\n    };\n\n    // Handler for the form submission (file upload)\n    const handleUploadFile = async (e: ChangeEvent<HTMLInputElement>) => {\n        e.preventDefault();\n        if (!e.target.files || e.target.files.length === 0) {\n            return;\n        }\n        setIsUploading(true); // Start the loading state\n        const file: File = e.target.files[0];\n        const formData = new FormData();\n        formData.append(\"file\", file);\n\n        try {\n            const idToken = await getToken(client);\n            if (!idToken) {\n                throw new Error(\"No authentication token available\");\n            }\n            const response: SimpleAPIResponse = await uploadFileApi(formData, idToken);\n            setUploadedFile(response);\n            setIsUploading(false);\n            setUploadedFileError(undefined);\n            listUploadedFiles(idToken);\n        } catch (error) {\n            console.error(error);\n            setIsUploading(false);\n            setUploadedFileError(`Error uploading file - please try again or contact admin.`);\n        }\n    };\n\n    return (\n        <div className={`${styles.container} ${className ?? \"\"}`}>\n            <div>\n                <Button id=\"calloutButton\" icon={<Add24Regular />} disabled={disabled} onClick={handleButtonClick}>\n                    Manage file uploads\n                </Button>\n\n                {isCalloutVisible && (\n                    <Callout\n                        role=\"dialog\"\n                        gapSpace={0}\n                        className={styles.callout}\n                        target=\"#calloutButton\"\n                        onDismiss={() => setIsCalloutVisible(false)}\n                        setInitialFocus\n                    >\n                        <form encType=\"multipart/form-data\">\n                            <div>\n                                <Label>Upload file:</Label>\n                                <input\n                                    accept=\".txt, .md, .json, .jpg, .jpeg, .bmp, .heic, .tiff, .pdf, .docx, .xlsx, .pptx, .html\"\n                                    className={styles.chooseFiles}\n                                    type=\"file\"\n                                    onChange={handleUploadFile}\n                                />\n                            </div>\n                        </form>\n\n                        {/* Show a loading message while files are being uploaded */}\n                        {isUploading && <Text>{\"Uploading files...\"}</Text>}\n                        {!isUploading && uploadedFileError && <Text>{uploadedFileError}</Text>}\n                        {!isUploading && uploadedFile && <Text>{uploadedFile.message}</Text>}\n\n                        {/* Display the list of already uploaded */}\n                        <h3>Previously uploaded files:</h3>\n\n                        {isLoading && <Text>Loading...</Text>}\n                        {!isLoading && uploadedFiles.length === 0 && <Text>No files uploaded yet</Text>}\n                        {uploadedFiles.map((filename, index) => {\n                            return (\n                                <div key={index} className={styles.list}>\n                                    <div className={styles.item}>{filename}</div>\n                                    {/* Button to remove a file from the list */}\n                                    <Button\n                                        icon={<Delete24Regular />}\n                                        onClick={() => handleRemoveFile(filename)}\n                                        disabled={deletionStatus[filename] === \"pending\" || deletionStatus[filename] === \"success\"}\n                                    >\n                                        {!deletionStatus[filename] && \"Delete file\"}\n                                        {deletionStatus[filename] == \"pending\" && \"Deleting file...\"}\n                                        {deletionStatus[filename] == \"error\" && \"Error deleting.\"}\n                                        {deletionStatus[filename] == \"success\" && \"File deleted\"}\n                                    </Button>\n                                </div>\n                            );\n                        })}\n                    </Callout>\n                )}\n            </div>\n        </div>\n    );\n};\n","import { useEffect, useState } from \"react\";\nimport { ChoiceGroup, IChoiceGroupOption, Stack, IDropdownOption, Dropdown } from \"@fluentui/react\";\n\nimport styles from \"./VectorSettings.module.css\";\nimport { RetrievalMode, VectorFieldOptions } from \"../../api\";\n\ninterface Props {\n    showImageOptions?: boolean;\n    updateRetrievalMode: (retrievalMode: RetrievalMode) => void;\n    updateVectorFields: (options: VectorFieldOptions[]) => void;\n}\n\nconst vectorFields: IChoiceGroupOption[] = [\n    {\n        key: VectorFieldOptions.Embedding,\n        text: \"Text Embeddings\"\n    },\n    {\n        key: VectorFieldOptions.ImageEmbedding,\n        text: \"Image Embeddings\"\n    },\n    {\n        key: VectorFieldOptions.Both,\n        text: \"Text and Image embeddings\"\n    }\n];\n\nexport const VectorSettings = ({ updateRetrievalMode, updateVectorFields, showImageOptions }: Props) => {\n    const [retrievalMode, setRetrievalMode] = useState<RetrievalMode>(RetrievalMode.Hybrid);\n    const [vectorFieldOption, setVectorFieldOption] = useState<string>();\n\n    const onRetrievalModeChange = (_ev: React.FormEvent<HTMLDivElement>, option?: IDropdownOption<RetrievalMode> | undefined) => {\n        setRetrievalMode(option?.data || RetrievalMode.Hybrid);\n        updateRetrievalMode(option?.data || RetrievalMode.Hybrid);\n    };\n\n    const onVectorFieldsChange = (_ev?: React.FormEvent<HTMLElement | HTMLInputElement>, option?: IChoiceGroupOption) => {\n        option && setVectorFieldOption(option.key);\n        let list;\n        if (option?.key === \"both\") {\n            list = [VectorFieldOptions.Embedding, VectorFieldOptions.ImageEmbedding];\n        } else {\n            list = [option?.key as VectorFieldOptions];\n        }\n        updateVectorFields(list);\n    };\n\n    useEffect(() => {\n        showImageOptions\n            ? updateVectorFields([VectorFieldOptions.Embedding, VectorFieldOptions.ImageEmbedding])\n            : updateVectorFields([VectorFieldOptions.Embedding]);\n    }, [showImageOptions]);\n\n    return (\n        <Stack className={styles.container} tokens={{ childrenGap: 10 }}>\n            <Dropdown\n                label=\"Retrieval mode\"\n                options={[\n                    { key: \"hybrid\", text: \"Vectors + Text (Hybrid)\", selected: retrievalMode == RetrievalMode.Hybrid, data: RetrievalMode.Hybrid },\n                    { key: \"vectors\", text: \"Vectors\", selected: retrievalMode == RetrievalMode.Vectors, data: RetrievalMode.Vectors },\n                    { key: \"text\", text: \"Text\", selected: retrievalMode == RetrievalMode.Text, data: RetrievalMode.Text }\n                ]}\n                required\n                onChange={onRetrievalModeChange}\n            />\n\n            {showImageOptions && [RetrievalMode.Vectors, RetrievalMode.Hybrid].includes(retrievalMode) && (\n                <ChoiceGroup\n                    options={vectorFields}\n                    onChange={onVectorFieldsChange}\n                    selectedKey={vectorFieldOption}\n                    defaultSelectedKey={VectorFieldOptions.Both}\n                    label=\"Vector Fields (Multi-query vector search)\"\n                />\n            )}\n        </Stack>\n    );\n};\n","import { Label } from \"@fluentui/react\";\nimport { useMsal } from \"@azure/msal-react\";\nimport {\n    DataGridBody,\n    DataGridRow,\n    DataGrid,\n    DataGridHeader,\n    DataGridHeaderCell,\n    DataGridCell,\n    createTableColumn,\n    TableColumnDefinition\n} from \"@fluentui/react-table\";\nimport { appServicesToken } from \"../../authConfig\";\n\ntype Claim = {\n    name: string;\n    value: string;\n};\n\nexport const TokenClaimsDisplay = () => {\n    const { instance } = useMsal();\n    const activeAccount = instance.getActiveAccount();\n\n    const ToString = (a: string | any) => {\n        if (typeof a === \"string\") {\n            return a;\n        } else {\n            return JSON.stringify(a);\n        }\n    };\n\n    let createClaims = (o: Record<string, unknown> | undefined) => {\n        return Object.keys(o ?? {}).map((key: string) => {\n            let originalKey = key;\n            try {\n                // Some claim names may be a URL to a full schema, just use the last part of the URL in this case\n                const url = new URL(key);\n                const parts = url.pathname.split(\"/\");\n                key = parts[parts.length - 1];\n            } catch (error) {\n                // Do not parse key if it's not a URL\n            }\n            return { name: key, value: ToString((o ?? {})[originalKey]) };\n        });\n    };\n    const items: Claim[] = createClaims(activeAccount?.idTokenClaims ?? appServicesToken?.user_claims);\n\n    const columns: TableColumnDefinition<Claim>[] = [\n        createTableColumn<Claim>({\n            columnId: \"name\",\n            compare: (a: Claim, b: Claim) => {\n                return a.name.localeCompare(b.name);\n            },\n            renderHeaderCell: () => {\n                return \"Name\";\n            },\n            renderCell: item => {\n                return item.name;\n            }\n        }),\n        createTableColumn<Claim>({\n            columnId: \"value\",\n            compare: (a: Claim, b: Claim) => {\n                return a.value.localeCompare(b.value);\n            },\n            renderHeaderCell: () => {\n                return \"Value\";\n            },\n            renderCell: item => {\n                return item.value;\n            }\n        })\n    ];\n\n    return (\n        <div>\n            <Label>ID Token Claims</Label>\n            <DataGrid items={items} columns={columns} sortable getRowId={item => item.name}>\n                <DataGridHeader>\n                    <DataGridRow>{({ renderHeaderCell }) => <DataGridHeaderCell>{renderHeaderCell()}</DataGridHeaderCell>}</DataGridRow>\n                </DataGridHeader>\n                <DataGridBody<Claim>>\n                    {({ item, rowId }) => <DataGridRow<Claim> key={rowId}>{({ renderCell }) => <DataGridCell>{renderCell(item)}</DataGridCell>}</DataGridRow>}\n                </DataGridBody>\n            </DataGrid>\n        </div>\n    );\n};\n","import { useEffect, useState } from \"react\";\nimport { Stack, Checkbox, IDropdownOption, Dropdown } from \"@fluentui/react\";\n\nimport styles from \"./GPT4VSettings.module.css\";\nimport { GPT4VInput } from \"../../api\";\n\ninterface Props {\n    gpt4vInputs: GPT4VInput;\n    isUseGPT4V: boolean;\n    updateGPT4VInputs: (input: GPT4VInput) => void;\n    updateUseGPT4V: (useGPT4V: boolean) => void;\n}\n\nexport const GPT4VSettings = ({ updateGPT4VInputs, updateUseGPT4V, isUseGPT4V, gpt4vInputs }: Props) => {\n    const [useGPT4V, setUseGPT4V] = useState<boolean>(isUseGPT4V);\n    const [vectorFieldOption, setVectorFieldOption] = useState<GPT4VInput>(gpt4vInputs || GPT4VInput.TextAndImages);\n\n    const onuseGPT4V = (_ev?: React.FormEvent<HTMLElement | HTMLInputElement>, checked?: boolean) => {\n        updateUseGPT4V(!!checked);\n        setUseGPT4V(!!checked);\n    };\n\n    const onSetGPT4VInput = (_ev: React.FormEvent<HTMLDivElement>, option?: IDropdownOption<GPT4VInput> | undefined) => {\n        if (option) {\n            const data = option.key as GPT4VInput;\n            updateGPT4VInputs(data || GPT4VInput.TextAndImages);\n            data && setVectorFieldOption(data);\n        }\n    };\n\n    useEffect(() => {\n        useGPT4V && updateGPT4VInputs(GPT4VInput.TextAndImages);\n    }, [useGPT4V]);\n\n    return (\n        <Stack className={styles.container} tokens={{ childrenGap: 10 }}>\n            <Checkbox checked={useGPT4V} label=\"Use GPT-4 Turbo with Vision\" onChange={onuseGPT4V} />\n            {useGPT4V && (\n                <Dropdown\n                    selectedKey={vectorFieldOption}\n                    label=\"GPT-4 Turbo with Vision Inputs\"\n                    options={[\n                        {\n                            key: GPT4VInput.TextAndImages,\n                            text: \"Images and text from index\"\n                        },\n                        { text: \"Images only\", key: GPT4VInput.Images },\n                        { text: \"Text only\", key: GPT4VInput.Texts }\n                    ]}\n                    required\n                    onChange={onSetGPT4VInput}\n                />\n            )}\n        </Stack>\n    );\n};\n","import { useRef, useState, useEffect } from \"react\";\nimport { Checkbox, Panel, DefaultButton, TextField, SpinButton, Slider } from \"@fluentui/react\";\nimport { SparkleFilled } from \"@fluentui/react-icons\";\nimport readNDJSONStream from \"ndjson-readablestream\";\n\nimport styles from \"./Chat.module.css\";\n\nimport {\n    chatApi,\n    configApi,\n    RetrievalMode,\n    ChatAppResponse,\n    ChatAppResponseOrError,\n    ChatAppRequest,\n    ResponseMessage,\n    VectorFieldOptions,\n    GPT4VInput\n} from \"../../api\";\nimport { Answer, AnswerError, AnswerLoading } from \"../../components/Answer\";\nimport { QuestionInput } from \"../../components/QuestionInput\";\nimport { ExampleList } from \"../../components/Example\";\nimport { UserChatMessage } from \"../../components/UserChatMessage\";\nimport { AnalysisPanel, AnalysisPanelTabs } from \"../../components/AnalysisPanel\";\nimport { SettingsButton } from \"../../components/SettingsButton\";\nimport { ClearChatButton } from \"../../components/ClearChatButton\";\nimport { UploadFile } from \"../../components/UploadFile\";\nimport { useLogin, getToken, isLoggedIn, requireAccessControl } from \"../../authConfig\";\nimport { VectorSettings } from \"../../components/VectorSettings\";\nimport { useMsal } from \"@azure/msal-react\";\nimport { TokenClaimsDisplay } from \"../../components/TokenClaimsDisplay\";\nimport { GPT4VSettings } from \"../../components/GPT4VSettings\";\n\nconst Chat = () => {\n    const [isConfigPanelOpen, setIsConfigPanelOpen] = useState(false);\n    const [promptTemplate, setPromptTemplate] = useState<string>(\"\");\n    const [temperature, setTemperature] = useState<number>(0.3);\n    const [minimumRerankerScore, setMinimumRerankerScore] = useState<number>(0);\n    const [minimumSearchScore, setMinimumSearchScore] = useState<number>(0);\n    const [retrieveCount, setRetrieveCount] = useState<number>(3);\n    const [retrievalMode, setRetrievalMode] = useState<RetrievalMode>(RetrievalMode.Hybrid);\n    const [useSemanticRanker, setUseSemanticRanker] = useState<boolean>(true);\n    const [shouldStream, setShouldStream] = useState<boolean>(true);\n    const [useSemanticCaptions, setUseSemanticCaptions] = useState<boolean>(false);\n    const [excludeCategory, setExcludeCategory] = useState<string>(\"\");\n    const [useSuggestFollowupQuestions, setUseSuggestFollowupQuestions] = useState<boolean>(false);\n    const [vectorFieldList, setVectorFieldList] = useState<VectorFieldOptions[]>([VectorFieldOptions.Embedding]);\n    const [useOidSecurityFilter, setUseOidSecurityFilter] = useState<boolean>(false);\n    const [useGroupsSecurityFilter, setUseGroupsSecurityFilter] = useState<boolean>(false);\n    const [gpt4vInput, setGPT4VInput] = useState<GPT4VInput>(GPT4VInput.TextAndImages);\n    const [useGPT4V, setUseGPT4V] = useState<boolean>(false);\n\n    const lastQuestionRef = useRef<string>(\"\");\n    const chatMessageStreamEnd = useRef<HTMLDivElement | null>(null);\n\n    const [isLoading, setIsLoading] = useState<boolean>(false);\n    const [isStreaming, setIsStreaming] = useState<boolean>(false);\n    const [error, setError] = useState<unknown>();\n\n    const [activeCitation, setActiveCitation] = useState<string>();\n    const [activeAnalysisPanelTab, setActiveAnalysisPanelTab] = useState<AnalysisPanelTabs | undefined>(undefined);\n\n    const [selectedAnswer, setSelectedAnswer] = useState<number>(0);\n    const [answers, setAnswers] = useState<[user: string, response: ChatAppResponse][]>([]);\n    const [streamedAnswers, setStreamedAnswers] = useState<[user: string, response: ChatAppResponse][]>([]);\n    const [showGPT4VOptions, setShowGPT4VOptions] = useState<boolean>(false);\n    const [showSemanticRankerOption, setShowSemanticRankerOption] = useState<boolean>(false);\n    const [showVectorOption, setShowVectorOption] = useState<boolean>(false);\n    const [showUserUpload, setShowUserUpload] = useState<boolean>(false);\n\n    const getConfig = async () => {\n        configApi().then(config => {\n            setShowGPT4VOptions(config.showGPT4VOptions);\n            setUseSemanticRanker(config.showSemanticRankerOption);\n            setShowSemanticRankerOption(config.showSemanticRankerOption);\n            setShowVectorOption(config.showVectorOption);\n            if (!config.showVectorOption) {\n                setRetrievalMode(RetrievalMode.Text);\n            }\n            setShowUserUpload(config.showUserUpload);\n        });\n    };\n\n    const handleAsyncRequest = async (question: string, answers: [string, ChatAppResponse][], setAnswers: Function, responseBody: ReadableStream<any>) => {\n        let answer: string = \"\";\n        let askResponse: ChatAppResponse = {} as ChatAppResponse;\n\n        const updateState = (newContent: string) => {\n            return new Promise(resolve => {\n                setTimeout(() => {\n                    answer += newContent;\n                    const latestResponse: ChatAppResponse = {\n                        ...askResponse,\n                        choices: [{ ...askResponse.choices[0], message: { content: answer, role: askResponse.choices[0].message.role } }]\n                    };\n                    setStreamedAnswers([...answers, [question, latestResponse]]);\n                    resolve(null);\n                }, 33);\n            });\n        };\n        try {\n            setIsStreaming(true);\n            for await (const event of readNDJSONStream(responseBody)) {\n                if (event[\"choices\"] && event[\"choices\"][0][\"context\"] && event[\"choices\"][0][\"context\"][\"data_points\"]) {\n                    event[\"choices\"][0][\"message\"] = event[\"choices\"][0][\"delta\"];\n                    askResponse = event as ChatAppResponse;\n                } else if (event[\"choices\"] && event[\"choices\"][0][\"delta\"][\"content\"]) {\n                    setIsLoading(false);\n                    await updateState(event[\"choices\"][0][\"delta\"][\"content\"]);\n                } else if (event[\"choices\"] && event[\"choices\"][0][\"context\"]) {\n                    // Update context with new keys from latest event\n                    askResponse.choices[0].context = { ...askResponse.choices[0].context, ...event[\"choices\"][0][\"context\"] };\n                } else if (event[\"error\"]) {\n                    throw Error(event[\"error\"]);\n                }\n            }\n        } finally {\n            setIsStreaming(false);\n        }\n        const fullResponse: ChatAppResponse = {\n            ...askResponse,\n            choices: [{ ...askResponse.choices[0], message: { content: answer, role: askResponse.choices[0].message.role } }]\n        };\n        return fullResponse;\n    };\n\n    const client = useLogin ? useMsal().instance : undefined;\n\n    const makeApiRequest = async (question: string) => {\n        lastQuestionRef.current = question;\n\n        error && setError(undefined);\n        setIsLoading(true);\n        setActiveCitation(undefined);\n        setActiveAnalysisPanelTab(undefined);\n\n        const token = client ? await getToken(client) : undefined;\n\n        try {\n            const messages: ResponseMessage[] = answers.flatMap(a => [\n                { content: a[0], role: \"user\" },\n                { content: a[1].choices[0].message.content, role: \"assistant\" }\n            ]);\n\n            const request: ChatAppRequest = {\n                messages: [...messages, { content: question, role: \"user\" }],\n                stream: shouldStream,\n                context: {\n                    overrides: {\n                        prompt_template: promptTemplate.length === 0 ? undefined : promptTemplate,\n                        exclude_category: excludeCategory.length === 0 ? undefined : excludeCategory,\n                        top: retrieveCount,\n                        temperature: temperature,\n                        minimum_reranker_score: minimumRerankerScore,\n                        minimum_search_score: minimumSearchScore,\n                        retrieval_mode: retrievalMode,\n                        semantic_ranker: useSemanticRanker,\n                        semantic_captions: useSemanticCaptions,\n                        suggest_followup_questions: useSuggestFollowupQuestions,\n                        use_oid_security_filter: useOidSecurityFilter,\n                        use_groups_security_filter: useGroupsSecurityFilter,\n                        vector_fields: vectorFieldList,\n                        use_gpt4v: useGPT4V,\n                        gpt4v_input: gpt4vInput\n                    }\n                },\n                // ChatAppProtocol: Client must pass on any session state received from the server\n                session_state: answers.length ? answers[answers.length - 1][1].choices[0].session_state : null\n            };\n\n            const response = await chatApi(request, token);\n            if (!response.body) {\n                throw Error(\"No response body\");\n            }\n            if (shouldStream) {\n                const parsedResponse: ChatAppResponse = await handleAsyncRequest(question, answers, setAnswers, response.body);\n                setAnswers([...answers, [question, parsedResponse]]);\n            } else {\n                const parsedResponse: ChatAppResponseOrError = await response.json();\n                if (response.status > 299 || !response.ok) {\n                    throw Error(parsedResponse.error || \"Unknown error\");\n                }\n                setAnswers([...answers, [question, parsedResponse as ChatAppResponse]]);\n            }\n        } catch (e) {\n            setError(e);\n        } finally {\n            setIsLoading(false);\n        }\n    };\n\n    const clearChat = () => {\n        lastQuestionRef.current = \"\";\n        error && setError(undefined);\n        setActiveCitation(undefined);\n        setActiveAnalysisPanelTab(undefined);\n        setAnswers([]);\n        setStreamedAnswers([]);\n        setIsLoading(false);\n        setIsStreaming(false);\n    };\n\n    useEffect(() => chatMessageStreamEnd.current?.scrollIntoView({ behavior: \"smooth\" }), [isLoading]);\n    useEffect(() => chatMessageStreamEnd.current?.scrollIntoView({ behavior: \"auto\" }), [streamedAnswers]);\n    useEffect(() => {\n        getConfig();\n    }, []);\n\n    const onPromptTemplateChange = (_ev?: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\n        setPromptTemplate(newValue || \"\");\n    };\n\n    const onTemperatureChange = (\n        newValue: number,\n        range?: [number, number],\n        event?: React.MouseEvent | React.TouchEvent | MouseEvent | TouchEvent | React.KeyboardEvent\n    ) => {\n        setTemperature(newValue);\n    };\n\n    const onMinimumSearchScoreChange = (_ev?: React.SyntheticEvent<HTMLElement, Event>, newValue?: string) => {\n        setMinimumSearchScore(parseFloat(newValue || \"0\"));\n    };\n\n    const onMinimumRerankerScoreChange = (_ev?: React.SyntheticEvent<HTMLElement, Event>, newValue?: string) => {\n        setMinimumRerankerScore(parseFloat(newValue || \"0\"));\n    };\n\n    const onRetrieveCountChange = (_ev?: React.SyntheticEvent<HTMLElement, Event>, newValue?: string) => {\n        setRetrieveCount(parseInt(newValue || \"3\"));\n    };\n\n    const onUseSemanticRankerChange = (_ev?: React.FormEvent<HTMLElement | HTMLInputElement>, checked?: boolean) => {\n        setUseSemanticRanker(!!checked);\n    };\n\n    const onUseSemanticCaptionsChange = (_ev?: React.FormEvent<HTMLElement | HTMLInputElement>, checked?: boolean) => {\n        setUseSemanticCaptions(!!checked);\n    };\n\n    const onShouldStreamChange = (_ev?: React.FormEvent<HTMLElement | HTMLInputElement>, checked?: boolean) => {\n        setShouldStream(!!checked);\n    };\n\n    const onExcludeCategoryChanged = (_ev?: React.FormEvent, newValue?: string) => {\n        setExcludeCategory(newValue || \"\");\n    };\n\n    const onUseSuggestFollowupQuestionsChange = (_ev?: React.FormEvent<HTMLElement | HTMLInputElement>, checked?: boolean) => {\n        setUseSuggestFollowupQuestions(!!checked);\n    };\n\n    const onUseOidSecurityFilterChange = (_ev?: React.FormEvent<HTMLElement | HTMLInputElement>, checked?: boolean) => {\n        setUseOidSecurityFilter(!!checked);\n    };\n\n    const onUseGroupsSecurityFilterChange = (_ev?: React.FormEvent<HTMLElement | HTMLInputElement>, checked?: boolean) => {\n        setUseGroupsSecurityFilter(!!checked);\n    };\n\n    const onExampleClicked = (example: string) => {\n        makeApiRequest(example);\n    };\n\n    const onShowCitation = (citation: string, index: number) => {\n        if (activeCitation === citation && activeAnalysisPanelTab === AnalysisPanelTabs.CitationTab && selectedAnswer === index) {\n            setActiveAnalysisPanelTab(undefined);\n        } else {\n            setActiveCitation(citation);\n            setActiveAnalysisPanelTab(AnalysisPanelTabs.CitationTab);\n        }\n\n        setSelectedAnswer(index);\n    };\n\n    const onToggleTab = (tab: AnalysisPanelTabs, index: number) => {\n        if (activeAnalysisPanelTab === tab && selectedAnswer === index) {\n            setActiveAnalysisPanelTab(undefined);\n        } else {\n            setActiveAnalysisPanelTab(tab);\n        }\n\n        setSelectedAnswer(index);\n    };\n\n    return (\n        <div className={styles.container}>\n            <div className={styles.commandsContainer}>\n                <ClearChatButton className={styles.commandButton} onClick={clearChat} disabled={!lastQuestionRef.current || isLoading} />\n                {showUserUpload && <UploadFile className={styles.commandButton} disabled={!isLoggedIn(client)} />}\n                <SettingsButton className={styles.commandButton} onClick={() => setIsConfigPanelOpen(!isConfigPanelOpen)} />\n            </div>\n            <div className={styles.chatRoot}>\n                <div className={styles.chatContainer}>\n                    {!lastQuestionRef.current ? (\n                        <div className={styles.chatEmptyState}>\n                            <SparkleFilled fontSize={\"120px\"} primaryFill={\"rgba(115, 118, 225, 1)\"} aria-hidden=\"true\" aria-label=\"Chat logo\" />\n                            <h1 className={styles.chatEmptyStateTitle}>Chat with us to learn python</h1>\n                            <h2 className={styles.chatEmptyStateSubtitle}>Ask anything that is related to python</h2>\n                            <ExampleList onExampleClicked={onExampleClicked} useGPT4V={useGPT4V} />\n                        </div>\n                    ) : (\n                        <div className={styles.chatMessageStream}>\n                            {isStreaming &&\n                                streamedAnswers.map((streamedAnswer, index) => (\n                                    <div key={index}>\n                                        <UserChatMessage message={streamedAnswer[0]} />\n                                        <div className={styles.chatMessageGpt}>\n                                            <Answer\n                                                isStreaming={true}\n                                                key={index}\n                                                answer={streamedAnswer[1]}\n                                                isSelected={false}\n                                                onCitationClicked={c => onShowCitation(c, index)}\n                                                onThoughtProcessClicked={() => onToggleTab(AnalysisPanelTabs.ThoughtProcessTab, index)}\n                                                onSupportingContentClicked={() => onToggleTab(AnalysisPanelTabs.SupportingContentTab, index)}\n                                                onFollowupQuestionClicked={q => makeApiRequest(q)}\n                                                showFollowupQuestions={useSuggestFollowupQuestions && answers.length - 1 === index}\n                                            />\n                                        </div>\n                                    </div>\n                                ))}\n                            {!isStreaming &&\n                                answers.map((answer, index) => (\n                                    <div key={index}>\n                                        <UserChatMessage message={answer[0]} />\n                                        <div className={styles.chatMessageGpt}>\n                                            <Answer\n                                                isStreaming={false}\n                                                key={index}\n                                                answer={answer[1]}\n                                                isSelected={selectedAnswer === index && activeAnalysisPanelTab !== undefined}\n                                                onCitationClicked={c => onShowCitation(c, index)}\n                                                onThoughtProcessClicked={() => onToggleTab(AnalysisPanelTabs.ThoughtProcessTab, index)}\n                                                onSupportingContentClicked={() => onToggleTab(AnalysisPanelTabs.SupportingContentTab, index)}\n                                                onFollowupQuestionClicked={q => makeApiRequest(q)}\n                                                showFollowupQuestions={useSuggestFollowupQuestions && answers.length - 1 === index}\n                                            />\n                                        </div>\n                                    </div>\n                                ))}\n                            {isLoading && (\n                                <>\n                                    <UserChatMessage message={lastQuestionRef.current} />\n                                    <div className={styles.chatMessageGptMinWidth}>\n                                        <AnswerLoading />\n                                    </div>\n                                </>\n                            )}\n                            {error ? (\n                                <>\n                                    <UserChatMessage message={lastQuestionRef.current} />\n                                    <div className={styles.chatMessageGptMinWidth}>\n                                        <AnswerError error={error.toString()} onRetry={() => makeApiRequest(lastQuestionRef.current)} />\n                                    </div>\n                                </>\n                            ) : null}\n                            <div ref={chatMessageStreamEnd} />\n                        </div>\n                    )}\n\n                    <div className={styles.chatInput}>\n                        <QuestionInput\n                            clearOnSend\n                            placeholder=\"Type a new question (e.g. What are variables?)\"\n                            disabled={isLoading}\n                            onSend={question => makeApiRequest(question)}\n                        />\n                    </div>\n                </div>\n\n                {answers.length > 0 && activeAnalysisPanelTab && (\n                    <AnalysisPanel\n                        className={styles.chatAnalysisPanel}\n                        activeCitation={activeCitation}\n                        onActiveTabChanged={x => onToggleTab(x, selectedAnswer)}\n                        citationHeight=\"810px\"\n                        answer={answers[selectedAnswer][1]}\n                        activeTab={activeAnalysisPanelTab}\n                    />\n                )}\n\n                <Panel\n                    headerText=\"Configure answer generation\"\n                    isOpen={isConfigPanelOpen}\n                    isBlocking={false}\n                    onDismiss={() => setIsConfigPanelOpen(false)}\n                    closeButtonAriaLabel=\"Close\"\n                    onRenderFooterContent={() => <DefaultButton onClick={() => setIsConfigPanelOpen(false)}>Close</DefaultButton>}\n                    isFooterAtBottom={true}\n                >\n                    <TextField\n                        className={styles.chatSettingsSeparator}\n                        defaultValue={promptTemplate}\n                        label=\"Override prompt template\"\n                        multiline\n                        autoAdjustHeight\n                        onChange={onPromptTemplateChange}\n                    />\n\n                    <Slider\n                        className={styles.chatSettingsSeparator}\n                        label=\"Temperature\"\n                        min={0}\n                        max={1}\n                        step={0.1}\n                        defaultValue={temperature}\n                        onChange={onTemperatureChange}\n                        showValue\n                        snapToStep\n                    />\n\n                    <SpinButton\n                        className={styles.chatSettingsSeparator}\n                        label=\"Minimum search score\"\n                        min={0}\n                        step={0.01}\n                        defaultValue={minimumSearchScore.toString()}\n                        onChange={onMinimumSearchScoreChange}\n                    />\n\n                    <SpinButton\n                        className={styles.chatSettingsSeparator}\n                        label=\"Minimum reranker score\"\n                        min={1}\n                        max={4}\n                        step={0.1}\n                        defaultValue={minimumRerankerScore.toString()}\n                        onChange={onMinimumRerankerScoreChange}\n                    />\n\n                    <SpinButton\n                        className={styles.chatSettingsSeparator}\n                        label=\"Retrieve this many search results:\"\n                        min={1}\n                        max={50}\n                        defaultValue={retrieveCount.toString()}\n                        onChange={onRetrieveCountChange}\n                    />\n                    <TextField className={styles.chatSettingsSeparator} label=\"Exclude category\" onChange={onExcludeCategoryChanged} />\n\n                    {showSemanticRankerOption && (\n                        <Checkbox\n                            className={styles.chatSettingsSeparator}\n                            checked={useSemanticRanker}\n                            label=\"Use semantic ranker for retrieval\"\n                            onChange={onUseSemanticRankerChange}\n                        />\n                    )}\n                    <Checkbox\n                        className={styles.chatSettingsSeparator}\n                        checked={useSemanticCaptions}\n                        label=\"Use query-contextual summaries instead of whole documents\"\n                        onChange={onUseSemanticCaptionsChange}\n                        disabled={!useSemanticRanker}\n                    />\n                    <Checkbox\n                        className={styles.chatSettingsSeparator}\n                        checked={useSuggestFollowupQuestions}\n                        label=\"Suggest follow-up questions\"\n                        onChange={onUseSuggestFollowupQuestionsChange}\n                    />\n\n                    {showGPT4VOptions && (\n                        <GPT4VSettings\n                            gpt4vInputs={gpt4vInput}\n                            isUseGPT4V={useGPT4V}\n                            updateUseGPT4V={useGPT4V => {\n                                setUseGPT4V(useGPT4V);\n                            }}\n                            updateGPT4VInputs={inputs => setGPT4VInput(inputs)}\n                        />\n                    )}\n\n                    {showVectorOption && (\n                        <VectorSettings\n                            showImageOptions={useGPT4V && showGPT4VOptions}\n                            updateVectorFields={(options: VectorFieldOptions[]) => setVectorFieldList(options)}\n                            updateRetrievalMode={(retrievalMode: RetrievalMode) => setRetrievalMode(retrievalMode)}\n                        />\n                    )}\n\n                    {useLogin && (\n                        <Checkbox\n                            className={styles.chatSettingsSeparator}\n                            checked={useOidSecurityFilter || requireAccessControl}\n                            label=\"Use oid security filter\"\n                            disabled={!isLoggedIn(client) || requireAccessControl}\n                            onChange={onUseOidSecurityFilterChange}\n                        />\n                    )}\n                    {useLogin && (\n                        <Checkbox\n                            className={styles.chatSettingsSeparator}\n                            checked={useGroupsSecurityFilter || requireAccessControl}\n                            label=\"Use groups security filter\"\n                            disabled={!isLoggedIn(client) || requireAccessControl}\n                            onChange={onUseGroupsSecurityFilterChange}\n                        />\n                    )}\n\n                    <Checkbox\n                        className={styles.chatSettingsSeparator}\n                        checked={shouldStream}\n                        label=\"Stream chat completion responses\"\n                        onChange={onShouldStreamChange}\n                    />\n                    {useLogin && <TokenClaimsDisplay />}\n                </Panel>\n            </div>\n        </div>\n    );\n};\n\nexport default Chat;\n","import React from \"react\";\nimport ReactDOM from \"react-dom/client\";\nimport { createHashRouter, RouterProvider } from \"react-router-dom\";\nimport { initializeIcons } from \"@fluentui/react\";\nimport { MsalProvider } from \"@azure/msal-react\";\nimport { PublicClientApplication, EventType, AccountInfo } from \"@azure/msal-browser\";\nimport { msalConfig, useLogin } from \"./authConfig\";\n\nimport \"./index.css\";\n\nimport Layout from \"./pages/layout/Layout\";\nimport Chat from \"./pages/chat/Chat\";\n\nvar layout;\nif (useLogin) {\n    var msalInstance = new PublicClientApplication(msalConfig);\n\n    // Default to using the first account if no account is active on page load\n    if (!msalInstance.getActiveAccount() && msalInstance.getAllAccounts().length > 0) {\n        // Account selection logic is app dependent. Adjust as needed for different use cases.\n        msalInstance.setActiveAccount(msalInstance.getActiveAccount());\n    }\n\n    // Listen for sign-in event and set active account\n    msalInstance.addEventCallback(event => {\n        if (event.eventType === EventType.LOGIN_SUCCESS && event.payload) {\n            const account = event.payload as AccountInfo;\n            msalInstance.setActiveAccount(account);\n        }\n    });\n\n    layout = (\n        <MsalProvider instance={msalInstance}>\n            <Layout />\n        </MsalProvider>\n    );\n} else {\n    layout = <Layout />;\n}\n\ninitializeIcons();\n\nconst router = createHashRouter([\n    {\n        path: \"/\",\n        element: layout,\n        children: [\n            {\n                index: true,\n                element: <Chat />\n            },\n            {\n                path: \"qa\",\n                lazy: () => import(\"./pages/ask/Ask\")\n            },\n            {\n                path: \"*\",\n                lazy: () => import(\"./pages/NoPage\")\n            }\n        ]\n    }\n]);\n\nReactDOM.createRoot(document.getElementById(\"root\") as HTMLElement).render(\n    <React.StrictMode>\n        <RouterProvider router={router} />\n    </React.StrictMode>\n);\n"],"file":"assets/index-38f37ea9.js"}